(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,52683,e=>{"use strict";let r;var n,a,i,o,s=e.i(43476),l=e.i(71645),d=e.i(54338),u=e.i(59141);e.i(1465);var f=e.i(34991);e.i(51718);var c=e.i(18357);let h=e=>{let r=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase());return r.charAt(0).toUpperCase()+r.slice(1)},m=(...e)=>e.filter((e,r,n)=>!!e&&""!==e.trim()&&n.indexOf(e)===r).join(" ").trim();var p={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let g=(0,l.forwardRef)(({color:e="currentColor",size:r=24,strokeWidth:n=2,absoluteStrokeWidth:a,className:i="",children:o,iconNode:s,...d},u)=>(0,l.createElement)("svg",{ref:u,...p,width:r,height:r,stroke:e,strokeWidth:a?24*Number(n)/Number(r):n,className:m("lucide",i),...!o&&!(e=>{for(let r in e)if(r.startsWith("aria-")||"role"===r||"title"===r)return!0})(d)&&{"aria-hidden":"true"},...d},[...s.map(([e,r])=>(0,l.createElement)(e,r)),...Array.isArray(o)?o:[o]])),b=(e,r)=>{let n=(0,l.forwardRef)(({className:n,...a},i)=>(0,l.createElement)(g,{ref:i,iconNode:r,className:m(`lucide-${h(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,n),...a}));return n.displayName=h(e),n},x=b("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),y=b("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]),v=b("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),w=b("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),A=b("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);function j(){let[e,r]=(0,l.useState)(!0),[n,a]=(0,l.useState)(""),[i,o]=(0,l.useState)(""),[d,f]=(0,l.useState)(""),[h,m]=(0,l.useState)(!1),[p,g]=(0,l.useState)(""),b=async r=>{r.preventDefault(),m(!0),g("");try{if(e)await (0,c.signInWithEmailAndPassword)(u.auth,n,i);else{let e=await (0,c.createUserWithEmailAndPassword)(u.auth,n,i);await (0,c.updateProfile)(e.user,{displayName:d})}}catch(e){g(e.message||"Something went wrong")}finally{m(!1)}};return(0,s.jsxs)("div",{className:"flex min-h-screen flex-col items-center justify-center p-6 bg-vibe-black relative overflow-hidden",children:[(0,s.jsx)("div",{className:"absolute top-[-20%] left-[-10%] w-[500px] h-[500px] bg-vibe-primary/20 rounded-full blur-[120px]"}),(0,s.jsx)("div",{className:"absolute bottom-[-20%] right-[-10%] w-[500px] h-[500px] bg-vibe-accent/20 rounded-full blur-[120px]"}),(0,s.jsxs)("div",{className:"w-full max-w-md z-10 glass-panel p-8 rounded-3xl border border-white/10 bg-white/5 backdrop-blur-xl shadow-2xl",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-vibe-primary to-vibe-accent mb-2",children:e?"Welcome Back":"Join VibeMap"}),(0,s.jsx)("p",{className:"text-vibe-text-secondary mb-8",children:e?"Sign in to see where your vibe is.":"Create an account to start sharing."}),(0,s.jsxs)("form",{onSubmit:b,className:"space-y-4",children:[!e&&(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(w,{className:"absolute left-3 top-3 h-5 w-5 text-vibe-text-secondary"}),(0,s.jsx)("input",{type:"text",placeholder:"Display Name",value:d,onChange:e=>f(e.target.value),className:"w-full bg-black/40 border border-white/10 rounded-xl px-10 py-3 text-white placeholder-vibe-text-secondary outline-none focus:border-vibe-primary focus:ring-1 focus:ring-vibe-primary transition-all",required:!0})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(y,{className:"absolute left-3 top-3 h-5 w-5 text-vibe-text-secondary"}),(0,s.jsx)("input",{type:"email",placeholder:"Email Address",value:n,onChange:e=>a(e.target.value),className:"w-full bg-black/40 border border-white/10 rounded-xl px-10 py-3 text-white placeholder-vibe-text-secondary outline-none focus:border-vibe-primary focus:ring-1 focus:ring-vibe-primary transition-all",required:!0})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(v,{className:"absolute left-3 top-3 h-5 w-5 text-vibe-text-secondary"}),(0,s.jsx)("input",{type:"password",placeholder:"Password",value:i,onChange:e=>o(e.target.value),className:"w-full bg-black/40 border border-white/10 rounded-xl px-10 py-3 text-white placeholder-vibe-text-secondary outline-none focus:border-vibe-primary focus:ring-1 focus:ring-vibe-primary transition-all",required:!0})]}),p&&(0,s.jsx)("p",{className:"text-vibe-error text-sm text-center",children:p}),(0,s.jsx)("button",{type:"submit",disabled:h,className:"w-full bg-gradient-to-r from-vibe-primary to-vibe-accent text-white font-bold py-3.5 rounded-xl hover:opacity-90 active:scale-[0.98] transition-all flex items-center justify-center gap-2 group",children:h?(0,s.jsx)(x,{className:"animate-spin"}):(0,s.jsxs)(s.Fragment,{children:[e?"Sign In":"Create Account",(0,s.jsx)(A,{className:"h-4 w-4 group-hover:translate-x-1 transition-transform"})]})})]}),(0,s.jsx)("div",{className:"mt-6 text-center",children:(0,s.jsx)("button",{onClick:()=>r(!e),className:"text-sm text-vibe-text-secondary hover:text-white transition-colors",children:e?"Don't have an account? Sign Up":"Already have an account? Sign In"})})]})]})}var _=e.i(47167);let N=l.createContext(null);function E(){}let U=new Set(["_calcMatrices","_calcFogMatrices","_updateCameraState","_updateSeaLevelZoom"]),k=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function F(e){if(!e)return null;if("string"==typeof e||("toJS"in e&&(e=e.toJS()),!e.layers))return e;let r={};for(let n of e.layers)r[n.id]=n;let n=e.layers.map(e=>{let n=null;"interactive"in e&&(n=Object.assign({},e),delete n.interactive);let a=r[e.ref];if(a)for(let r of(n=n||Object.assign({},e),delete n.ref,k))r in a&&(n[r]=a[r]);return n||e});return{...e,layers:n}}function C(e,r){if(e===r)return!0;if(!e||!r)return!1;if(Array.isArray(e)){if(!Array.isArray(r)||e.length!==r.length)return!1;for(let n=0;n<e.length;n++)if(!C(e[n],r[n]))return!1;return!0}if(Array.isArray(r))return!1;if("object"==typeof e&&"object"==typeof r){let n=Object.keys(e),a=Object.keys(r);if(n.length!==a.length)return!1;for(let a of n)if(!r.hasOwnProperty(a)||!C(e[a],r[a]))return!1;return!0}return!1}let M={version:8,sources:{},layers:[]},S={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},L={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},R={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},T=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],I=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class z{constructor(e,r,n){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=e=>{let r=this.props[R[e.type]];r?r(e):"error"===e.type&&console.error(e.error)},this._onPointerEvent=e=>{("mousemove"===e.type||"mouseout"===e.type)&&this._updateHover(e);let r=this.props[S[e.type]];r&&(this.props.interactiveLayerIds&&"mouseover"!==e.type&&"mouseout"!==e.type&&(e.features=this._hoveredFeatures||this._queryRenderedFeatures(e.point)),r(e),delete e.features)},this._onCameraEvent=e=>{if(!this._internalUpdate){let n=this.props[L[e.type]],a=this._proxyTransform;if(n){var r;e.viewState={longitude:(r=a.$proposedTransform??a).center.lng,latitude:r.center.lat,zoom:r._seaLevelZoom??r.zoom,pitch:r.pitch,bearing:r.bearing,padding:r.padding,elevation:r._centerAltitude},n(e)}"moveend"===e.type&&(a.$proposedTransform=null)}e.type in this._deferredEvents&&(this._deferredEvents[e.type]=!1)},this._MapClass=e,this.props=r,this._initialize(n)}get map(){return this._map}get transform(){return this._map.transform}setProps(e){let r=this.props;this.props=e;let n=this._updateSettings(e,r);n&&this._createProxyTransform(this._map);let a=this._updateSize(e),i=this._updateViewState(e,!0);this._updateStyle(e,r),this._updateStyleComponents(e,r),this._updateHandlers(e,r),(n||a||i&&!this._map.isMoving())&&this.redraw()}static reuse(e,r){let n=z.savedMaps.pop();if(!n)return null;let a=n.map,i=a.getContainer();for(r.className=i.className;i.childNodes.length>0;)r.appendChild(i.childNodes[0]);a._container=r,n.setProps({...e,styleDiffing:!1}),a.resize();let{initialViewState:o}=e;return o&&(o.bounds?a.fitBounds(o.bounds,{...o.fitBoundsOptions,duration:0}):n._updateViewState(o,!1)),a.isStyleLoaded()?a.fire("load"):a.once("styledata",()=>a.fire("load")),a._update(),n}_initialize(e){let{props:r}=this,{mapStyle:n=M}=r,a={...r,...r.initialViewState,accessToken:r.mapboxAccessToken||function(){let e=null;if("undefined"!=typeof location){let r=/access_token=([^&\/]*)/.exec(location.search);e=r&&r[1]}try{e=e||_.default.env.MapboxAccessToken}catch{}try{e=e||_.default.env.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return e}()||null,container:e,style:F(n)},i=a.initialViewState||a.viewState||a;if(Object.assign(a,{center:[i.longitude||0,i.latitude||0],zoom:i.zoom||0,pitch:i.pitch||0,bearing:i.bearing||0}),r.gl){let e=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=e,r.gl)}let o=new this._MapClass(a);i.padding&&o.setPadding(i.padding),r.cursor&&(o.getCanvas().style.cursor=r.cursor),this._createProxyTransform(o);let s=o._render;o._render=e=>{this._inRender=!0,s.call(o,e),this._inRender=!1};let l=o._renderTaskQueue.run;o._renderTaskQueue.run=e=>{this._proxyTransform.$internalUpdate=!0,l.call(o._renderTaskQueue,e),this._proxyTransform.$internalUpdate=!1,this._fireDefferedEvents()};let d=o.jumpTo;o.jumpTo=(...e)=>(this._proxyTransform.$internalUpdate=!0,d.apply(o,e),this._proxyTransform.$internalUpdate=!1,o);let u=o.fire;for(let e in o.fire=this._fireEvent.bind(this,u),o.on("styledata",()=>{this._updateStyleComponents(this.props,{})}),o.on("sourcedata",()=>{this._updateStyleComponents(this.props,{})}),S)o.on(e,this._onPointerEvent);for(let e in L)o.on(e,this._onCameraEvent);for(let e in R)o.on(e,this._onEvent);this._map=o}recycle(){let e=this.map.getContainer().querySelector("[mapboxgl-children]");e?.remove(),z.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){let e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createProxyTransform(e){var r;let n,a,i,o=(r=e.transform,n=!1,a={},i=null,new Proxy(r,{get(e,o){var s;return"$reactViewState"===o?a:"$proposedTransform"===o?i:"$internalUpdate"===o?n:"_setZoom"===o?e=>{n&&i?.[o](e),Number.isFinite(a.zoom)||r[o](e)}:(n&&"_translateCameraConstrained"===o&&(Number.isFinite((s=a).longitude)||Number.isFinite(s.latitude)||Number.isFinite(s.zoom)||Number.isFinite(s.pitch)||Number.isFinite(s.bearing))&&(i=i||r.clone()),U.has(o))?function(...e){i?.[o](...e),r[o](...e)}:n&&i?i[o]:r[o]},set(e,o,s){if("$reactViewState"===o)return!function(e,r){let n=e._constrain,a=e._calcMatrices;if(e._constrain=E,e._calcMatrices=E,Number.isFinite(r.bearing)&&(e.bearing=r.bearing),Number.isFinite(r.pitch)&&(e.pitch=r.pitch),r.padding&&!e.isPaddingEqual(r.padding)&&(e.padding=r.padding),Number.isFinite(r.longitude)||Number.isFinite(r.latitude)){let n=e.center;e._center=new n.constructor(r.longitude??n.lng,r.latitude??n.lat)}if(Number.isFinite(r.zoom))if(e._centerAltitude=r.elevation??0,e.elevation){e._seaLevelZoom=r.zoom;let n=e.pixelsPerMeter/e.worldSize*e._centerAltitude,a=Math.max(e._mercatorZfromZoom(r.zoom)-n,e._mercatorZfromZoom(e._maxZoom));e._setZoom(e._zoomFromMercatorZ(a))}else e._seaLevelZoom=null,e.zoom=r.zoom;e._constrain=n,e._calcMatrices=a,e._unmodified||(e._constrain(),e._calcMatrices())}(r,a=s),!0;if("$proposedTransform"===o)return i=s,!0;if("$internalUpdate"===o)return n=s,!0;let l=s;return"center"===o||"_center"===o?(Number.isFinite(a.longitude)||Number.isFinite(a.latitude))&&(l=new s.constructor(a.longitude??s.lng,a.latitude??s.lat)):"zoom"===o||"_zoom"===o||"_seaLevelZoom"===o?Number.isFinite(a.zoom)&&(l=r[o]):"_centerAltitude"===o?Number.isFinite(a.elevation)&&(l=r[o]):"pitch"===o||"_pitch"===o?Number.isFinite(a.pitch)&&(l=r[o]):("bearing"===o||"rotation"===o||"angle"===o)&&Number.isFinite(a.bearing)&&(l=r[o]),n&&l!==s&&(i=i||r.clone()),n&&i&&(i[o]=s),r[o]=l,!0}}));e.transform=o,e.painter.transform=o,this._proxyTransform=o}_updateSize(e){let{viewState:r}=e;if(r){let e=this._map;if(r.width!==e.transform.width||r.height!==e.transform.height)return e.resize(),!0}return!1}_updateViewState(e,r){var n;let a=e.viewState||e,i=this._proxyTransform,{zoom:o,pitch:s,bearing:l}=i,d=(n=this._proxyTransform,!(!(Number.isFinite(a.longitude)&&n.center.lng!==a.longitude||Number.isFinite(a.latitude)&&n.center.lat!==a.latitude||Number.isFinite(a.bearing)&&n.bearing!==a.bearing||Number.isFinite(a.pitch)&&n.pitch!==a.pitch||Number.isFinite(a.zoom)&&(n._seaLevelZoom??n.zoom)!==a.zoom)&&(!a.padding||n.isPaddingEqual(a.padding))));if(i.$reactViewState=a,d&&r){let e=this._deferredEvents;e.move=!0,e.zoom||(e.zoom=o!==i.zoom),e.rotate||(e.rotate=l!==i.bearing),e.pitch||(e.pitch=s!==i.pitch)}return d}_updateSettings(e,r){let n=this._map,a=!1;for(let i of T)if(i in e&&!C(e[i],r[i])){a=!0;let r=n[`set${i[0].toUpperCase()}${i.slice(1)}`];r?.call(n,e[i])}return a}_updateStyle(e,r){if(e.cursor!==r.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==r.mapStyle){let{mapStyle:r=M,styleDiffing:n=!0}=e,a={diff:n};return"localIdeographFontFamily"in e&&(a.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(F(r),a),!0}return!1}_updateStyleComponents(e,r){let n=this._map,a=!1;return n.isStyleLoaded()&&("light"in e&&n.setLight&&!C(e.light,r.light)&&(a=!0,n.setLight(e.light)),"fog"in e&&n.setFog&&!C(e.fog,r.fog)&&(a=!0,n.setFog(e.fog)),"terrain"in e&&n.setTerrain&&!C(e.terrain,r.terrain)&&(!e.terrain||n.getSource(e.terrain.source))&&(a=!0,n.setTerrain(e.terrain))),a}_updateHandlers(e,r){let n=this._map,a=!1;for(let i of I){let o=e[i]??!0;C(o,r[i]??!0)||(a=!0,o?n[i].enable(o):n[i].disable())}return a}_queryRenderedFeatures(e){let r=this._map,{interactiveLayerIds:n=[]}=this.props;try{return r.queryRenderedFeatures(e,{layers:n.filter(r.getLayer.bind(r))})}catch{return[]}}_updateHover(e){let{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){let r=e.type,n=this._hoveredFeatures?.length>0,a=this._queryRenderedFeatures(e.point),i=a.length>0;!i&&n&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=a,i&&!n&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=r}else this._hoveredFeatures=null}_fireEvent(e,r,n){let a=this._map,i=this._proxyTransform,o=i.$internalUpdate;try{i.$internalUpdate=!1,e.call(a,r,n)}finally{i.$internalUpdate=o}return a}_fireDefferedEvents(){let e=this._map;for(let r in this._internalUpdate=!0,this._deferredEvents)this._deferredEvents[r]&&e.fire(r);this._internalUpdate=!1}}z.savedMaps=[];let B=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"],P="undefined"!=typeof document?l.useLayoutEffect:l.useEffect,O=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"],D=l.createContext(null),Q=l.forwardRef(function(r,n){let a=(0,l.useContext)(N),[i,o]=(0,l.useState)(null),s=(0,l.useRef)(),{current:d}=(0,l.useRef)({mapLib:null,map:null});(0,l.useEffect)(()=>{let n,i=r.mapLib,l=!0;return Promise.resolve(i||e.A(52498)).then(e=>{if(!l)return;if(!e)throw Error("Invalid mapLib");let i="Map"in e?e:e.default;if(!i.Map)throw Error("Invalid mapLib");!function(e,r){for(let n of O)n in r&&(e[n]=r[n]);let{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=r;n&&e.getRTLTextPluginStatus&&"unavailable"===e.getRTLTextPluginStatus()&&e.setRTLTextPlugin(n,e=>{e&&console.error(e)},!0)}(i,r),r.reuseMaps&&(n=z.reuse(r,s.current)),n||(n=new z(i.Map,r,s.current)),d.map=function(e){if(!e)return null;let r=e.map,n={getMap:()=>r,getCenter:()=>e.transform.center,getZoom:()=>e.transform.zoom,getBearing:()=>e.transform.bearing,getPitch:()=>e.transform.pitch,getPadding:()=>e.transform.padding,getBounds:()=>e.transform.getBounds(),project:n=>{let a=r.transform;r.transform=e.transform;let i=r.project(n);return r.transform=a,i},unproject:n=>{let a=r.transform;r.transform=e.transform;let i=r.unproject(n);return r.transform=a,i},queryTerrainElevation:(n,a)=>{let i=r.transform;r.transform=e.transform;let o=r.queryTerrainElevation(n,a);return r.transform=i,o},queryRenderedFeatures:(n,a)=>{let i=r.transform;r.transform=e.transform;let o=r.queryRenderedFeatures(n,a);return r.transform=i,o}};for(let e of function(e){let r=new Set,n=e;for(;n;){for(let a of Object.getOwnPropertyNames(n))"_"!==a[0]&&"function"==typeof e[a]&&"fire"!==a&&"setEventedParent"!==a&&r.add(a);n=Object.getPrototypeOf(n)}return Array.from(r)}(r))e in n||B.includes(e)||(n[e]=r[e].bind(r));return n}(n),d.mapLib=i,o(n),a?.onMapMount(d.map,r.id)}).catch(e=>{let{onError:n}=r;n?n({type:"error",target:null,error:e}):console.error(e)}),()=>{l=!1,n&&(a?.onMapUnmount(r.id),r.reuseMaps?n.recycle():n.destroy())}},[]),P(()=>{i&&i.setProps(r)}),(0,l.useImperativeHandle)(n,()=>d.map,[i]);let u=(0,l.useMemo)(()=>({position:"relative",width:"100%",height:"100%",...r.style}),[r.style]);return l.createElement("div",{id:r.id,ref:s,style:u},i&&l.createElement(D.Provider,{value:d},l.createElement("div",{"mapboxgl-children":"",style:{height:"100%"}},r.children)))});var $=e.i(74080);let q=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function H(e,r){if(!e||!r)return;let n=e.style;for(let e in r){let a=r[e];Number.isFinite(a)&&!q.test(e)?n[e]=`${a}px`:n[e]=a}}function Z(e,r){if(e===r)return null;let n=W(e),a=W(r),i=[];for(let e of a)n.has(e)||i.push(e);for(let e of n)a.has(e)||i.push(e);return 0===i.length?null:i}function W(e){return new Set(e?e.trim().split(/\s+/):[])}let V=(0,l.memo)((0,l.forwardRef)((e,r)=>{var n;let a,i,o,s,{map:d,mapLib:u}=(0,l.useContext)(D),f=(0,l.useRef)({props:e}),c=(0,l.useMemo)(()=>{let r=!1;l.Children.forEach(e.children,e=>{e&&(r=!0)});let n={...e,element:r?document.createElement("div"):null},a=new u.Marker(n);return a.setLngLat([e.longitude,e.latitude]),a.getElement().addEventListener("click",e=>{f.current.props.onClick?.({type:"click",target:a,originalEvent:e})}),a.on("dragstart",e=>{e.lngLat=c.getLngLat(),f.current.props.onDragStart?.(e)}),a.on("drag",e=>{e.lngLat=c.getLngLat(),f.current.props.onDrag?.(e)}),a.on("dragend",e=>{e.lngLat=c.getLngLat(),f.current.props.onDragEnd?.(e)}),a},[]);(0,l.useEffect)(()=>(c.addTo(d.getMap()),()=>{c.remove()}),[]);let{longitude:h,latitude:m,offset:p,style:g,draggable:b=!1,popup:x=null,rotation:y=0,rotationAlignment:v="auto",pitchAlignment:w="auto"}=e;(0,l.useEffect)(()=>{H(c.getElement(),g)},[g]),(0,l.useImperativeHandle)(r,()=>c,[]);let A=f.current.props;(c.getLngLat().lng!==h||c.getLngLat().lat!==m)&&c.setLngLat([h,m]),p&&(n=c.getOffset(),a=Array.isArray(n)?n[0]:n?n.x:0,i=Array.isArray(n)?n[1]:n?n.y:0,o=Array.isArray(p)?p[0]:p?p.x:0,s=Array.isArray(p)?p[1]:p?p.y:0,a!==o||i!==s)&&c.setOffset(p),c.isDraggable()!==b&&c.setDraggable(b),c.getRotation()!==y&&c.setRotation(y),c.getRotationAlignment()!==v&&c.setRotationAlignment(v),c.getPitchAlignment()!==w&&c.setPitchAlignment(w),c.getPopup()!==x&&c.setPopup(x);let j=Z(A.className,e.className);if(j)for(let e of j)c.toggleClassName(e);return f.current.props=e,(0,$.createPortal)(e.children,c.getElement())}));function G(e,r,n,a){let i=(0,l.useContext)(D),o=(0,l.useMemo)(()=>e(i),[]);return(0,l.useEffect)(()=>{let e="function"==typeof r&&"function"==typeof n?r:null,s="function"==typeof n?n:"function"==typeof r?r:null,{map:l}=i;return!l.hasControl(o)&&(l.addControl(o,(a||n||r)?.position),e&&e(i)),()=>{s&&s(i),l.hasControl(o)&&l.removeControl(o)}},[]),o}(0,l.memo)((0,l.forwardRef)((e,r)=>{let{map:n,mapLib:a}=(0,l.useContext)(D),i=(0,l.useMemo)(()=>document.createElement("div"),[]),o=(0,l.useRef)({props:e}),s=(0,l.useMemo)(()=>{let r={...e},n=new a.Popup(r);return n.setLngLat([e.longitude,e.latitude]),n.once("open",e=>{o.current.props.onOpen?.(e)}),n},[]);if((0,l.useEffect)(()=>{let e=e=>{o.current.props.onClose?.(e)};return s.on("close",e),s.setDOMContent(i).addTo(n.getMap()),()=>{s.off("close",e),s.isOpen()&&s.remove()}},[]),(0,l.useEffect)(()=>{H(s.getElement(),e.style)},[e.style]),(0,l.useImperativeHandle)(r,()=>s,[]),s.isOpen()){let r=o.current.props;(s.getLngLat().lng!==e.longitude||s.getLngLat().lat!==e.latitude)&&s.setLngLat([e.longitude,e.latitude]),e.offset&&!C(r.offset,e.offset)&&(s.options.anchor=e.anchor,s.setOffset(e.offset)),(r.anchor!==e.anchor||r.maxWidth!==e.maxWidth)&&s.setMaxWidth(e.maxWidth);let n=Z(r.className,e.className);if(n)for(let e of n)s.toggleClassName(e);o.current.props=e}return(0,$.createPortal)(e.children,i)})),(0,l.memo)(function(e){let r=G(({mapLib:r})=>new r.AttributionControl(e),{position:e.position});return(0,l.useEffect)(()=>{H(r._container,e.style)},[e.style]),null}),(0,l.memo)(function(e){let r=G(({mapLib:r})=>new r.FullscreenControl({container:e.containerId&&document.getElementById(e.containerId)}),{position:e.position});return(0,l.useEffect)(()=>{H(r._controlContainer,e.style)},[e.style]),null});let K=(0,l.memo)((0,l.forwardRef)(function(e,r){let n=(0,l.useRef)({props:e}),a=G(({mapLib:r})=>{let a=new r.GeolocateControl(e),i=a._setupUI.bind(a);return a._setupUI=e=>{a._container.hasChildNodes()||i(e)},a.on("geolocate",e=>{n.current.props.onGeolocate?.(e)}),a.on("error",e=>{n.current.props.onError?.(e)}),a.on("outofmaxbounds",e=>{n.current.props.onOutOfMaxBounds?.(e)}),a.on("trackuserlocationstart",e=>{n.current.props.onTrackUserLocationStart?.(e)}),a.on("trackuserlocationend",e=>{n.current.props.onTrackUserLocationEnd?.(e)}),a},{position:e.position});return n.current.props=e,(0,l.useImperativeHandle)(r,()=>a,[]),(0,l.useEffect)(()=>{H(a._container,e.style)},[e.style]),null})),J=(0,l.memo)(function(e){let r=G(({mapLib:r})=>new r.NavigationControl(e),{position:e.position});return(0,l.useEffect)(()=>{H(r._container,e.style)},[e.style]),null});(0,l.memo)(function(e){let r=G(({mapLib:r})=>new r.ScaleControl(e),{position:e.position}),n=(0,l.useRef)(e),a=n.current;n.current=e;let{style:i}=e;return void 0!==e.maxWidth&&e.maxWidth!==a.maxWidth&&(r.options.maxWidth=e.maxWidth),void 0!==e.unit&&e.unit!==a.unit&&r.setUnit(e.unit),(0,l.useEffect)(()=>{H(r._container,i)},[i]),null}),e.s([],20235),e.s([],23144),e.s([],27530),e.s([],51955),e.s(["default",0,Q],82604),e.i(82604),e.i(20235),e.i(23144),e.i(27530),e.i(51955);let X=b("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),Y=b("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]);function ee(e){let[r,n]=(0,l.useState)([]);return(0,l.useEffect)(()=>{if(!e)return;let r=(0,f.ref)(u.database,`users/${e.uid}/friends`),a={},i=(0,f.onValue)(r,e=>{a=e.val()||{}}),o=(0,f.ref)(u.database,"users"),s=(0,f.onValue)(o,e=>{let r=e.val();r&&a?n(Object.entries(r).filter(([e])=>!0===a[e]).map(([e,r])=>({uid:e,...r}))):n([])});return()=>{i(),s()}},[e]),{friends:r}}var et=e.i(98345),er=e.i(63178);function en({userLocation:e,speed:r,onChatStart:n,onOpenFriends:a}){let{user:i}=(0,d.useAuth)(),{friends:o}=ee(i),{t:u}=(0,et.useLanguage)(),{resolvedTheme:f}=(0,er.useTheme)(),[c,h]=(0,l.useState)(!1),[m,p]=(0,l.useState)({latitude:10.7769,longitude:106.7009,zoom:14});return(0,l.useEffect)(()=>{e&&!c&&(p(r=>({...r,latitude:e.lat,longitude:e.lng,zoom:15})),h(!0))},[e,c]),(0,s.jsxs)("div",{className:"w-full h-full relative bg-background",children:[(0,s.jsxs)(Q,{...m,onMove:e=>p(e.viewState),style:{width:"100%",height:"100%"},mapStyle:"light"===f?"mapbox://styles/mapbox/streets-v12":"mapbox://styles/mapbox/dark-v11",mapboxAccessToken:"pk.eyJ1IjoiaHV5bHUiLCJhIjoiY21qc2JtMmtzMnl5MzNucHZsbTFmcXFpcSJ9.JATVS0t1zf4qbIRV6GgJqg",attributionControl:!1,children:[(0,s.jsx)(K,{position:"top-right",trackUserLocation:!0,positionOptions:{enableHighAccuracy:!0,timeout:5e3,maximumAge:1e4},onGeolocate:e=>{p(r=>({...r,latitude:e.coords.latitude,longitude:e.coords.longitude,zoom:15}))}}),(0,s.jsx)(J,{position:"top-right"}),i&&e&&(0,s.jsx)(V,{longitude:e.lng,latitude:e.lat,anchor:"bottom",children:(0,s.jsxs)("div",{className:"relative group flex flex-col items-center",children:[(0,s.jsx)("div",{className:"absolute -inset-4 bg-primary/20 rounded-full animate-ping pointer-events-none"}),(0,s.jsx)("div",{className:"w-12 h-12 rounded-full border-2 border-primary bg-card/90 backdrop-blur-md flex items-center justify-center shadow-lg overflow-hidden z-10 relative",children:i.photoURL?(0,s.jsx)("img",{src:i.photoURL,alt:"Me",className:"w-full h-full object-cover"}):(0,s.jsx)(w,{className:"text-primary w-6 h-6"})}),(0,s.jsx)("div",{className:"absolute -bottom-6 text-xs bg-primary/90 text-primary-foreground font-bold px-2 py-1 rounded whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity z-50 pointer-events-none",children:u("map.you")})]})}),null!=r&&r>0&&(0,s.jsxs)("div",{className:"absolute top-4 right-16 md:right-20 bg-background/80 backdrop-blur-md border border-border px-3 py-1.5 rounded-full shadow-lg z-10 flex items-center gap-1.5",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),(0,s.jsxs)("span",{className:"text-sm font-bold tabular-nums",children:[(3.6*r).toFixed(1)," ",(0,s.jsx)("span",{className:"text-xs font-normal text-muted-foreground",children:"km/h"})]})]}),o.map(e=>e.location&&(0,s.jsx)(V,{longitude:e.location.lng,latitude:e.location.lat,anchor:"bottom",onClick:r=>{r.originalEvent.stopPropagation(),n?.({uid:e.uid,displayName:e.name||"Friend",photoURL:e.photoURL})},children:(0,s.jsxs)("div",{className:"relative group flex flex-col items-center cursor-pointer transition-transform hover:scale-110",children:[(0,s.jsx)("div",{className:`w-3 h-3 rounded-full border-2 border-background mb-1 ${"online"===e.status?"bg-green-500":"bg-muted-foreground"}`}),(0,s.jsx)("div",{className:"w-10 h-10 rounded-full border-2 border-primary/50 bg-card/80 backdrop-blur-md flex items-center justify-center shadow-lg overflow-hidden",children:e.photoURL?(0,s.jsx)("img",{src:e.photoURL,alt:e.name,className:"w-full h-full object-cover"}):(0,s.jsx)(w,{className:"text-foreground w-6 h-6"})}),(0,s.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity bg-background/60 rounded-full p-2 z-20 backdrop-blur-sm",children:(0,s.jsx)(Y,{className:"w-5 h-5 text-primary"})}),void 0!==e.battery&&(0,s.jsxs)("div",{className:"absolute -top-4 right-[-10px] bg-background/80 rounded px-1 flex items-center gap-0.5 border border-border",children:[(0,s.jsxs)("span",{className:`text-[10px] ${e.battery<20?"text-destructive":"text-foreground"}`,children:[e.battery,"%"]}),e.isCharging&&(0,s.jsx)(X,{className:"w-2 h-2 text-yellow-400 fill-yellow-400"})]}),(0,s.jsx)("div",{className:"absolute -bottom-6 text-xs bg-background/80 text-foreground px-2 py-1 rounded whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity z-50 pointer-events-none",children:e.name||"Friend"})]})},e.uid))]}),(0,s.jsx)("div",{className:"absolute bottom-8 left-0 right-0 flex justify-center pointer-events-none pb-[env(safe-area-inset-bottom)]",children:(0,s.jsxs)("div",{onClick:a,className:"glass-panel px-6 py-3 rounded-full pointer-events-auto border border-border bg-card/40 backdrop-blur-xl flex items-center gap-3 cursor-pointer hover:bg-card/60 transition-colors active:scale-95 shadow-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("span",{className:"relative flex h-3 w-3",children:[(0,s.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-primary opacity-75"}),(0,s.jsx)("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-primary"})]}),(0,s.jsx)("span",{className:"text-foreground text-sm font-medium",children:u("map.active")})]}),(0,s.jsx)("div",{className:"h-4 w-[1px] bg-border"}),(0,s.jsxs)("span",{className:"text-muted-foreground text-sm",children:[o.length," ",u("map.friends_online")]})]})})]})}let ea=b("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),ei=b("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function eo({user:e,friendUid:r,friendName:n,onClose:a}){let{messages:i,sendMessage:o,loading:d}=function(e,r){let[n,a]=(0,l.useState)([]),[i,o]=(0,l.useState)(!1),s=e&&r?[e.uid,r].sort().join("_"):null;return(0,l.useEffect)(()=>{if(!s)return void a([]);o(!0);let e=(0,f.ref)(u.database,`chats/${s}/messages`),r=(0,f.query)(e,(0,f.limitToLast)(50)),n=(0,f.onValue)(r,e=>{let r=e.val();r?a(Object.entries(r).map(([e,r])=>({id:e,...r})).sort((e,r)=>e.timestamp-r.timestamp)):a([]),o(!1)});return()=>n()},[s]),{messages:n,sendMessage:async r=>{if(!s||!e||!r.trim())return;let n=(0,f.ref)(u.database,`chats/${s}/messages`);await (0,f.push)(n,{senderId:e.uid,text:r.trim(),timestamp:Date.now()})},loading:i,chatId:s}}(e,r),{t:c}=(0,et.useLanguage)(),{resolvedTheme:h}=(0,er.useTheme)(),[m,p]=(0,l.useState)(""),g=(0,l.useRef)(null);(0,l.useEffect)(()=>{g.current?.scrollIntoView({behavior:"smooth"})},[i]);let b=async e=>{e?.preventDefault(),m.trim()&&(p(""),await o(m))};return(0,s.jsxs)("div",{className:`fixed bottom-0 right-0 md:bottom-20 md:right-8 w-full md:w-80 h-[60dvh] md:h-96 flex flex-col ${"light"===h?"bg-white":"bg-[#1E1E1E]"} md:rounded-2xl border-t md:border border-neutral-200 dark:border-neutral-800 shadow-2xl z-50 overflow-hidden pb-[env(safe-area-inset-bottom)]`,children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 border-b border-border bg-muted/50",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),(0,s.jsx)("span",{className:"font-semibold text-foreground",children:n})]}),(0,s.jsx)("button",{onClick:a,className:"p-1 text-muted-foreground hover:text-foreground rounded-full hover:bg-muted transition-colors",children:(0,s.jsx)(ei,{size:18})})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 custom-scrollbar scroll-smooth bg-background",children:[d&&0===i.length&&(0,s.jsx)("div",{className:"flex justify-center py-4",children:(0,s.jsx)(x,{className:"animate-spin text-primary"})}),0===i.length&&!d&&(0,s.jsxs)("div",{className:"text-center text-muted-foreground text-xs mt-10",children:[c("common.chat")," ",n,"!"]}),i.map(r=>{let n=r.senderId===e.uid;return(0,s.jsx)("div",{className:`flex ${n?"justify-end":"justify-start"}`,children:(0,s.jsx)("div",{className:`max-w-[80%] rounded-2xl px-3 py-2 text-sm break-words ${n?"bg-primary text-primary-foreground rounded-tr-none font-medium":"bg-muted text-foreground rounded-tl-none border border-border"}`,children:r.text})},r.id)}),(0,s.jsx)("div",{ref:g})]}),(0,s.jsxs)("form",{onSubmit:b,className:"p-3 border-t border-border bg-card flex gap-2",children:[(0,s.jsx)("input",{type:"text",value:m,onChange:e=>p(e.target.value),placeholder:c("chat.placeholder"),className:"flex-1 bg-input border border-border rounded-full px-4 py-2 text-sm text-foreground focus:outline-none focus:border-primary transition-colors placeholder:text-muted-foreground"}),(0,s.jsx)("button",{type:"submit",disabled:!m.trim(),className:"p-2 bg-primary text-primary-foreground rounded-full disabled:opacity-50 disabled:cursor-not-allowed hover:bg-primary/90 transition-transform active:scale-95",children:(0,s.jsx)(ea,{size:18})})]})]})}e.i(61086);var es=e.i(27215);let el=b("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),ed=b("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),eu=b("moon",[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]]),ef=b("sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),ec=b("laptop",[["path",{d:"M18 5a2 2 0 0 1 2 2v8.526a2 2 0 0 0 .212.897l1.068 2.127a1 1 0 0 1-.9 1.45H3.62a1 1 0 0 1-.9-1.45l1.068-2.127A2 2 0 0 0 4 15.526V7a2 2 0 0 1 2-2z",key:"1pdavp"}],["path",{d:"M20.054 15.987H3.946",key:"14rxg9"}]]);function eh(e,r){return new Promise(function(n,a){let i;return em(e).then(function(e){try{return i=e,n(new Blob([r.slice(0,2),i,r.slice(2)],{type:"image/jpeg"}))}catch(e){return a(e)}},a)})}let em=e=>new Promise((r,n)=>{let a=new FileReader;a.addEventListener("load",({target:{result:e}})=>{let a=new DataView(e),i=0;if(65496!==a.getUint16(i))return n("not a valid JPEG");for(i+=2;;){let o=a.getUint16(i);if(65498===o)break;let s=a.getUint16(i+2);if(65505===o&&0x45786966===a.getUint32(i+4)){let o,l=i+10;switch(a.getUint16(l)){case 18761:o=!0;break;case 19789:o=!1;break;default:return n("TIFF header contains invalid endian")}if(42!==a.getUint16(l+2,o))return n("TIFF header contains invalid version");let d=a.getUint32(l+4,o),u=l+d+2+12*a.getUint16(l+d,o);for(let e=l+d+2;e<u;e+=12)if(274==a.getUint16(e,o)){if(3!==a.getUint16(e+2,o))return n("Orientation data type is invalid");if(1!==a.getUint32(e+4,o))return n("Orientation data count is invalid");a.setUint16(e+8,1,o);break}return r(e.slice(i,i+2+s))}i+=2+s}return r(new Blob)}),a.readAsArrayBuffer(e)});var ep={};({get exports(){return ep},set exports(t){ep=t}}).exports=i={},i.parse=function(e,r){for(var n=i.bin.readUshort,a=i.bin.readUint,o=0,s={},l=new Uint8Array(e),d=l.length-4;0x6054b50!=a(l,d);)d--;var u=n(l,o=d+4+4);n(l,o+=2);var f=a(l,o+=2),c=a(l,o+=4);o+=4,o=c;for(var h=0;h<u;h++){a(l,o),o+=4,o+=4,o+=4,a(l,o+=4),f=a(l,o+=4);var m=a(l,o+=4),p=n(l,o+=4),g=n(l,o+2),b=n(l,o+4);o+=6;var x=a(l,o+=8);o+=4,o+=p+g+b,i._readLocal(l,x,s,f,m,r)}return s},i._readLocal=function(e,r,n,a,o,s){var l=i.bin.readUshort,d=i.bin.readUint;d(e,r),l(e,r+=4),l(e,r+=2);var u=l(e,r+=2);d(e,r+=2),d(e,r+=4),r+=4;var f=l(e,r+=8),c=l(e,r+=2);r+=2;var h=i.bin.readUTF8(e,r,f);if(r+=f,r+=c,s)n[h]={size:o,csize:a};else{var m=new Uint8Array(e.buffer,r);if(0==u)n[h]=new Uint8Array(m.buffer.slice(r,r+a));else{if(8!=u)throw"unknown compression method: "+u;var p=new Uint8Array(o);i.inflateRaw(m,p),n[h]=p}}},i.inflateRaw=function(e,r){return i.F.inflate(e,r)},i.inflate=function(e,r){return e[0],e[1],i.inflateRaw(new Uint8Array(e.buffer,e.byteOffset+2,e.length-6),r)},i.deflate=function(e,r){null==r&&(r={level:6});var n=0,a=new Uint8Array(50+Math.floor(1.1*e.length));a[n]=120,a[n+1]=156,n+=2,n=i.F.deflateRaw(e,a,n,r.level);var o=i.adler(e,0,e.length);return a[n+0]=o>>>24&255,a[n+1]=o>>>16&255,a[n+2]=o>>>8&255,a[n+3]=o>>>0&255,new Uint8Array(a.buffer,0,n+4)},i.deflateRaw=function(e,r){null==r&&(r={level:6});var n=new Uint8Array(50+Math.floor(1.1*e.length)),a=i.F.deflateRaw(e,n,a,r.level);return new Uint8Array(n.buffer,0,a)},i.encode=function(e,r){null==r&&(r=!1);var n=0,a=i.bin.writeUint,o=i.bin.writeUshort,s={};for(var l in e){var d=!i._noNeed(l)&&!r,u=e[l],f=i.crc.crc(u,0,u.length);s[l]={cpr:d,usize:u.length,crc:f,file:d?i.deflateRaw(u):u}}for(var l in s)n+=s[l].file.length+30+46+2*i.bin.sizeUTF8(l);var c=new Uint8Array(n+=22),h=0,m=[];for(var l in s){var p=s[l];m.push(h),h=i._writeHeader(c,h,l,p,0)}var g=0,b=h;for(var l in s)p=s[l],m.push(h),h=i._writeHeader(c,h,l,p,1,m[g++]);var x=h-b;return a(c,h,0x6054b50),h+=4,o(c,h+=4,g),o(c,h+=2,g),a(c,h+=2,x),a(c,h+=4,b),h+=4,h+=2,c.buffer},i._noNeed=function(e){var r=e.split(".").pop().toLowerCase();return -1!="png,jpg,jpeg,zip".indexOf(r)},i._writeHeader=function(e,r,n,a,o,s){var l=i.bin.writeUint,d=i.bin.writeUshort,u=a.file;return l(e,r,0==o?0x4034b50:0x2014b50),r+=4,1==o&&(r+=2),d(e,r,20),d(e,r+=2,0),d(e,r+=2,8*!!a.cpr),l(e,r+=2,0),l(e,r+=4,a.crc),l(e,r+=4,u.length),l(e,r+=4,a.usize),d(e,r+=4,i.bin.sizeUTF8(n)),d(e,r+=2,0),r+=2,1==o&&(r+=2,r+=2,l(e,r+=6,s),r+=4),r+=i.bin.writeUTF8(e,r,n),0==o&&(e.set(u,r),r+=u.length),r},i.crc={table:function(){for(var e=new Uint32Array(256),r=0;r<256;r++){for(var n=r,a=0;a<8;a++)1&n?n=0xedb88320^n>>>1:n>>>=1;e[r]=n}return e}(),update:function(e,r,n,a){for(var o=0;o<a;o++)e=i.crc.table[255&(e^r[n+o])]^e>>>8;return e},crc:function(e,r,n){return 0xffffffff^i.crc.update(0xffffffff,e,r,n)}},i.adler=function(e,r,n){for(var a=1,i=0,o=r,s=r+n;o<s;){for(var l=Math.min(o+5552,s);o<l;)i+=a+=e[o++];a%=65521,i%=65521}return i<<16|a},i.bin={readUshort:function(e,r){return e[r]|e[r+1]<<8},writeUshort:function(e,r,n){e[r]=255&n,e[r+1]=n>>8&255},readUint:function(e,r){return 0x1000000*e[r+3]+(e[r+2]<<16|e[r+1]<<8|e[r])},writeUint:function(e,r,n){e[r]=255&n,e[r+1]=n>>8&255,e[r+2]=n>>16&255,e[r+3]=n>>24&255},readASCII:function(e,r,n){for(var a="",i=0;i<n;i++)a+=String.fromCharCode(e[r+i]);return a},writeASCII:function(e,r,n){for(var a=0;a<n.length;a++)e[r+a]=n.charCodeAt(a)},pad:function(e){return e.length<2?"0"+e:e},readUTF8:function(e,r,n){for(var a,o="",s=0;s<n;s++)o+="%"+i.bin.pad(e[r+s].toString(16));try{a=decodeURIComponent(o)}catch(a){return i.bin.readASCII(e,r,n)}return a},writeUTF8:function(e,r,n){for(var a=n.length,i=0,o=0;o<a;o++){var s=n.charCodeAt(o);if(0==(0xffffff80&s))e[r+i]=s,i++;else if(0==(0xfffff800&s))e[r+i]=192|s>>6,e[r+i+1]=128|63&s,i+=2;else if(0==(0xffff0000&s))e[r+i]=224|s>>12,e[r+i+1]=128|s>>6&63,e[r+i+2]=128|63&s,i+=3;else{if(0!=(0xffe00000&s))throw"e";e[r+i]=240|s>>18,e[r+i+1]=128|s>>12&63,e[r+i+2]=128|s>>6&63,e[r+i+3]=128|63&s,i+=4}}return i},sizeUTF8:function(e){for(var r=e.length,n=0,a=0;a<r;a++){var i=e.charCodeAt(a);if(0==(0xffffff80&i))n++;else if(0==(0xfffff800&i))n+=2;else if(0==(0xffff0000&i))n+=3;else{if(0!=(0xffe00000&i))throw"e";n+=4}}return n}},i.F={},i.F.deflateRaw=function(e,r,n,a){var o=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][a],s=i.F.U,l=i.F._goodIndex;i.F._hash;var d=i.F._putsE,u=0,f=n<<3,c=0,h=e.length;if(0==a){for(;u<h;)d(r,f,+(u+(N=Math.min(65535,h-u))==h)),f=i.F._copyExact(e,u,N,r,f+8),u+=N;return f>>>3}var m=s.lits,p=s.strt,g=s.prev,b=0,x=0,y=0,v=0,w=0,A=0;for(h>2&&(p[A=i.F._hash(e,0)]=0),u=0;u<h;u++){if(w=A,u+1<h-2){A=i.F._hash(e,u+1);var j=u+1&32767;g[j]=p[A],p[A]=j}if(c<=u){(b>14e3||x>26697)&&h-u>100&&(c<u&&(m[b]=u-c,b+=2,c=u),f=i.F._writeBlock(+(u==h-1||c==h),m,b,v,e,y,u-y,r,f),b=x=v=0,y=u);var _=0;u<h-2&&(_=i.F._bestMatch(e,u,g,w,Math.min(o[2],h-u),o[3]));var N=_>>>16,E=65535&_;if(0!=_){E=65535&_;var U=l(N=_>>>16,s.of0);s.lhst[257+U]++;var k=l(E,s.df0);s.dhst[k]++,v+=s.exb[U]+s.dxb[k],m[b]=N<<23|u-c,m[b+1]=E<<16|U<<8|k,b+=2,c=u+N}else s.lhst[e[u]]++;x++}}for(y==u&&0!=e.length||(c<u&&(m[b]=u-c,b+=2,c=u),f=i.F._writeBlock(1,m,b,v,e,y,u-y,r,f),b=0,x=0,b=x=v=0,y=u);0!=(7&f);)f++;return f>>>3},i.F._bestMatch=function(e,r,n,a,o,s){var l=32767&r,d=n[l],u=l-d+32768&32767;if(d==l||a!=i.F._hash(e,r-u))return 0;for(var f=0,c=0,h=Math.min(32767,r);u<=h&&0!=--s&&d!=l;){if(0==f||e[r+f]==e[r+f-u]){var m=i.F._howLong(e,r,u);if(m>f){if(c=u,(f=m)>=o)break;u+2<m&&(m=u+2);for(var p=0,g=0;g<m-2;g++){var b=r-u+g+32768&32767,x=b-n[b]+32768&32767;x>p&&(p=x,d=b)}}}u+=(l=d)-(d=n[l])+32768&32767}return f<<16|c},i.F._howLong=function(e,r,n){if(e[r]!=e[r-n]||e[r+1]!=e[r+1-n]||e[r+2]!=e[r+2-n])return 0;var a=r,i=Math.min(e.length,r+258);for(r+=3;r<i&&e[r]==e[r-n];)r++;return r-a},i.F._hash=function(e,r){return(e[r]<<8|e[r+1])+(e[r+2]<<4)&65535},i.saved=0,i.F._writeBlock=function(e,r,n,a,o,s,l,d,u){var f,c,h,m,p,g,b,x,y,v,w,A=i.F.U,j=i.F._putsF,_=i.F._putsE;A.lhst[256]++,m=(h=i.F.getTrees())[0],p=h[1],g=h[2],b=h[3],x=h[4],y=h[5],v=h[6],w=h[7];var N=32+(0==(u+3&7)?0:8-(u+3&7))+(l<<3),E=a+i.F.contSize(A.fltree,A.lhst)+i.F.contSize(A.fdtree,A.dhst),U=a+i.F.contSize(A.ltree,A.lhst)+i.F.contSize(A.dtree,A.dhst);U+=14+3*y+i.F.contSize(A.itree,A.ihst)+(2*A.ihst[16]+3*A.ihst[17]+7*A.ihst[18]);for(var k=0;k<286;k++)A.lhst[k]=0;for(k=0;k<30;k++)A.dhst[k]=0;for(k=0;k<19;k++)A.ihst[k]=0;var F=N<E&&N<U?0:E<U?1:2;if(j(d,u,e),j(d,u+1,F),u+=3,0==F){for(;0!=(7&u);)u++;u=i.F._copyExact(o,s,l,d,u)}else{if(1==F&&(f=A.fltree,c=A.fdtree),2==F){i.F.makeCodes(A.ltree,m),i.F.revCodes(A.ltree,m),i.F.makeCodes(A.dtree,p),i.F.revCodes(A.dtree,p),i.F.makeCodes(A.itree,g),i.F.revCodes(A.itree,g),f=A.ltree,c=A.dtree,_(d,u,b-257),_(d,u+=5,x-1),_(d,u+=5,y-4),u+=4;for(var C=0;C<y;C++)_(d,u+3*C,A.itree[1+(A.ordr[C]<<1)]);u+=3*y,u=i.F._codeTiny(v,A.itree,d,u),u=i.F._codeTiny(w,A.itree,d,u)}for(var M=s,S=0;S<n;S+=2){for(var L=r[S],R=L>>>23,T=M+(8388607&L);M<T;)u=i.F._writeLit(o[M++],f,d,u);if(0!=R){var I=r[S+1],z=I>>16,B=I>>8&255,P=255&I;_(d,u=i.F._writeLit(257+B,f,d,u),R-A.of0[B]),u+=A.exb[B],j(d,u=i.F._writeLit(P,c,d,u),z-A.df0[P]),u+=A.dxb[P],M+=R}}u=i.F._writeLit(256,f,d,u)}return u},i.F._copyExact=function(e,r,n,a,i){var o=i>>>3;return a[o]=n,a[o+1]=n>>>8,a[o+2]=255-a[o],a[o+3]=255-a[o+1],o+=4,a.set(new Uint8Array(e.buffer,r,n),o),i+(n+4<<3)},i.F.getTrees=function(){for(var e=i.F.U,r=i.F._hufTree(e.lhst,e.ltree,15),n=i.F._hufTree(e.dhst,e.dtree,15),a=[],o=i.F._lenCodes(e.ltree,a),s=[],l=i.F._lenCodes(e.dtree,s),d=0;d<a.length;d+=2)e.ihst[a[d]]++;for(d=0;d<s.length;d+=2)e.ihst[s[d]]++;for(var u=i.F._hufTree(e.ihst,e.itree,7),f=19;f>4&&0==e.itree[1+(e.ordr[f-1]<<1)];)f--;return[r,n,u,o,l,f,a,s]},i.F.getSecond=function(e){for(var r=[],n=0;n<e.length;n+=2)r.push(e[n+1]);return r},i.F.nonZero=function(e){for(var r="",n=0;n<e.length;n+=2)0!=e[n+1]&&(r+=(n>>1)+",");return r},i.F.contSize=function(e,r){for(var n=0,a=0;a<r.length;a++)n+=r[a]*e[1+(a<<1)];return n},i.F._codeTiny=function(e,r,n,a){for(var o=0;o<e.length;o+=2){var s=e[o],l=e[o+1];a=i.F._writeLit(s,r,n,a);var d=16==s?2:17==s?3:7;s>15&&(i.F._putsE(n,a,l,d),a+=d)}return a},i.F._lenCodes=function(e,r){for(var n=e.length;2!=n&&0==e[n-1];)n-=2;for(var a=0;a<n;a+=2){var i=e[a+1],o=a+3<n?e[a+3]:-1,s=a+5<n?e[a+5]:-1,l=0==a?-1:e[a-1];if(0==i&&o==i&&s==i){for(var d=a+5;d+2<n&&e[d+2]==i;)d+=2;(u=Math.min(d+1-a>>>1,138))<11?r.push(17,u-3):r.push(18,u-11),a+=2*u-2}else if(i==l&&o==i&&s==i){for(d=a+5;d+2<n&&e[d+2]==i;)d+=2;var u=Math.min(d+1-a>>>1,6);r.push(16,u-3),a+=2*u-2}else r.push(i,0)}return n>>>1},i.F._hufTree=function(e,r,n){var a=[],o=e.length,s=r.length,l=0;for(l=0;l<s;l+=2)r[l]=0,r[l+1]=0;for(l=0;l<o;l++)0!=e[l]&&a.push({lit:l,f:e[l]});var d=a.length,u=a.slice(0);if(0==d)return 0;if(1==d){var f=a[0].lit;return u=+(0==f),r[1+(f<<1)]=1,r[1+(u<<1)]=1,1}a.sort(function(e,r){return e.f-r.f});var c=a[0],h=a[1],m=0,p=1,g=2;for(a[0]={lit:-1,f:c.f+h.f,l:c,r:h,d:0};p!=d-1;)c=m!=p&&(g==d||a[m].f<a[g].f)?a[m++]:a[g++],h=m!=p&&(g==d||a[m].f<a[g].f)?a[m++]:a[g++],a[p++]={lit:-1,f:c.f+h.f,l:c,r:h};var b=i.F.setDepth(a[p-1],0);for(b>n&&(i.F.restrictDepth(u,n,b),b=n),l=0;l<d;l++)r[1+(u[l].lit<<1)]=u[l].d;return b},i.F.setDepth=function(e,r){return -1!=e.lit?(e.d=r,r):Math.max(i.F.setDepth(e.l,r+1),i.F.setDepth(e.r,r+1))},i.F.restrictDepth=function(e,r,n){var a=0,i=1<<n-r,o=0;for(e.sort(function(e,r){return r.d==e.d?e.f-r.f:r.d-e.d}),a=0;a<e.length&&e[a].d>r;a++){var s=e[a].d;e[a].d=r,o+=i-(1<<n-s)}for(o>>>=n-r;o>0;)(s=e[a].d)<r?(e[a].d++,o-=1<<r-s-1):a++;for(;a>=0;a--)e[a].d==r&&o<0&&(e[a].d--,o++);0!=o&&console.log("debt left")},i.F._goodIndex=function(e,r){var n=0;return r[16]<=e&&(n|=16),r[8|n]<=e&&(n|=8),r[4|n]<=e&&(n|=4),r[2|n]<=e&&(n|=2),r[1|n]<=e&&(n|=1),n},i.F._writeLit=function(e,r,n,a){return i.F._putsF(n,a,r[e<<1]),a+r[1+(e<<1)]},i.F.inflate=function(e,r){var n=Uint8Array;if(3==e[0]&&0==e[1])return r||new n(0);var a=i.F,o=a._bitsF,s=a._bitsE,l=a._decodeTiny,d=a.makeCodes,u=a.codes2map,f=a._get17,c=a.U,h=null==r;h&&(r=new n(e.length>>>2<<3));for(var m,p,g=0,b=0,x=0,y=0,v=0,w=0,A=0,j=0,_=0;0==g;)if(g=o(e,_,1),b=o(e,_+1,2),_+=3,0!=b){if(h&&(r=i.F._check(r,j+131072)),1==b&&(m=c.flmap,p=c.fdmap,w=511,A=31),2==b){x=s(e,_,5)+257,y=s(e,_+5,5)+1,v=s(e,_+10,4)+4,_+=14;for(var N=0;N<38;N+=2)c.itree[N]=0,c.itree[N+1]=0;var E=1;for(N=0;N<v;N++){var U=s(e,_+3*N,3);c.itree[1+(c.ordr[N]<<1)]=U,U>E&&(E=U)}_+=3*v,d(c.itree,E),u(c.itree,E,c.imap),m=c.lmap,p=c.dmap,_=l(c.imap,(1<<E)-1,x+y,e,_,c.ttree);var k=a._copyOut(c.ttree,0,x,c.ltree);w=(1<<k)-1;var F=a._copyOut(c.ttree,x,y,c.dtree);A=(1<<F)-1,d(c.ltree,k),u(c.ltree,k,m),d(c.dtree,F),u(c.dtree,F,p)}for(;;){var C=m[f(e,_)&w];_+=15&C;var M=C>>>4;if(M>>>8==0)r[j++]=M;else{if(256==M)break;var S=j+M-254;if(M>264){var L=c.ldef[M-257];S=j+(L>>>3)+s(e,_,7&L),_+=7&L}var R=p[f(e,_)&A];_+=15&R;var T=R>>>4,I=c.ddef[T],z=(I>>>4)+o(e,_,15&I);for(_+=15&I,h&&(r=i.F._check(r,j+131072));j<S;)r[j]=r[j++-z],r[j]=r[j++-z],r[j]=r[j++-z],r[j]=r[j++-z];j=S}}}else{0!=(7&_)&&(_+=8-(7&_));var B=4+(_>>>3),P=e[B-4]|e[B-3]<<8;h&&(r=i.F._check(r,j+P)),r.set(new n(e.buffer,e.byteOffset+B,P),j),_=B+P<<3,j+=P}return r.length==j?r:r.slice(0,j)},i.F._check=function(e,r){var n=e.length;if(r<=n)return e;var a=new Uint8Array(Math.max(n<<1,r));return a.set(e,0),a},i.F._decodeTiny=function(e,r,n,a,o,s){for(var l=i.F._bitsE,d=i.F._get17,u=0;u<n;){var f=e[d(a,o)&r];o+=15&f;var c=f>>>4;if(c<=15)s[u]=c,u++;else{var h=0,m=0;16==c?(m=3+l(a,o,2),o+=2,h=s[u-1]):17==c?(m=3+l(a,o,3),o+=3):18==c&&(m=11+l(a,o,7),o+=7);for(var p=u+m;u<p;)s[u]=h,u++}}return o},i.F._copyOut=function(e,r,n,a){for(var i=0,o=0,s=a.length>>>1;o<n;){var l=e[o+r];a[o<<1]=0,a[1+(o<<1)]=l,l>i&&(i=l),o++}for(;o<s;)a[o<<1]=0,a[1+(o<<1)]=0,o++;return i},i.F.makeCodes=function(e,r){for(var n,a,o,s,l=i.F.U,d=e.length,u=l.bl_count,f=0;f<=r;f++)u[f]=0;for(f=1;f<d;f+=2)u[e[f]]++;var c=l.next_code;for(n=0,u[0]=0,a=1;a<=r;a++)n=n+u[a-1]<<1,c[a]=n;for(o=0;o<d;o+=2)0!=(s=e[o+1])&&(e[o]=c[s],c[s]++)},i.F.codes2map=function(e,r,n){for(var a=e.length,o=i.F.U.rev15,s=0;s<a;s+=2)if(0!=e[s+1])for(var l=s>>1,d=e[s+1],u=l<<4|d,f=r-d,c=e[s]<<f,h=c+(1<<f);c!=h;)n[o[c]>>>15-r]=u,c++},i.F.revCodes=function(e,r){for(var n=i.F.U.rev15,a=15-r,o=0;o<e.length;o+=2){var s=e[o]<<r-e[o+1];e[o]=n[s]>>>a}},i.F._putsE=function(e,r,n){n<<=7&r;var a=r>>>3;e[a]|=n,e[a+1]|=n>>>8},i.F._putsF=function(e,r,n){n<<=7&r;var a=r>>>3;e[a]|=n,e[a+1]|=n>>>8,e[a+2]|=n>>>16},i.F._bitsE=function(e,r,n){return(e[r>>>3]|e[1+(r>>>3)]<<8)>>>(7&r)&(1<<n)-1},i.F._bitsF=function(e,r,n){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16)>>>(7&r)&(1<<n)-1},i.F._get17=function(e,r){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16)>>>(7&r)},i.F._get25=function(e,r){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16|e[3+(r>>>3)]<<24)>>>(7&r)},i.F.U=(n=Uint16Array,a=Uint32Array,{next_code:new n(16),bl_count:new n(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new n(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new a(32),flmap:new n(512),fltree:[],fdmap:new n(32),fdtree:[],lmap:new n(32768),ltree:[],ttree:[],dmap:new n(32768),dtree:[],imap:new n(512),itree:[],rev15:new n(32768),lhst:new a(286),dhst:new a(30),ihst:new a(19),lits:new a(15e3),strt:new n(65536),prev:new n(32768)}),function(){for(var e=i.F.U,r=0;r<32768;r++){var n=r;n=(0xff00ff00&(n=(0xf0f0f0f0&(n=(0xcccccccc&(n=(0xaaaaaaaa&n)>>>1|(0x55555555&n)<<1))>>>2|(0x33333333&n)<<2))>>>4|(0xf0f0f0f&n)<<4))>>>8|(0xff00ff&n)<<8,e.rev15[r]=(n>>>16|n<<16)>>>17}function a(e,r,n){for(;0!=r--;)e.push(0,n)}for(r=0;r<32;r++)e.ldef[r]=e.of0[r]<<3|e.exb[r],e.ddef[r]=e.df0[r]<<4|e.dxb[r];a(e.fltree,144,8),a(e.fltree,112,9),a(e.fltree,24,7),a(e.fltree,8,8),i.F.makeCodes(e.fltree,9),i.F.codes2map(e.fltree,9,e.flmap),i.F.revCodes(e.fltree,9),a(e.fdtree,32,5),i.F.makeCodes(e.fdtree,5),i.F.codes2map(e.fdtree,5,e.fdmap),i.F.revCodes(e.fdtree,5),a(e.itree,19,0),a(e.ltree,286,0),a(e.dtree,30,0),a(e.ttree,320,0)}();var eg=(o={__proto__:null,default:ep},[ep].forEach(function(e){e&&"string"!=typeof e&&!Array.isArray(e)&&Object.keys(e).forEach(function(r){if("default"!==r&&!(r in o)){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(o,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})}),Object.freeze(o));let eb=function(){let e,r,n;var a={nextZero(e,r){for(;0!=e[r];)r++;return r},readUshort:(e,r)=>e[r]<<8|e[r+1],writeUshort(e,r,n){e[r]=n>>8&255,e[r+1]=255&n},readUint:(e,r)=>0x1000000*e[r]+(e[r+1]<<16|e[r+2]<<8|e[r+3]),writeUint(e,r,n){e[r]=n>>24&255,e[r+1]=n>>16&255,e[r+2]=n>>8&255,e[r+3]=255&n},readASCII(e,r,n){let a="";for(let i=0;i<n;i++)a+=String.fromCharCode(e[r+i]);return a},writeASCII(e,r,n){for(let a=0;a<n.length;a++)e[r+a]=n.charCodeAt(a)},readBytes(e,r,n){let a=[];for(let i=0;i<n;i++)a.push(e[r+i]);return a},pad:e=>e.length<2?`0${e}`:e,readUTF8(e,r,n){let i,o="";for(let i=0;i<n;i++)o+=`%${a.pad(e[r+i].toString(16))}`;try{i=decodeURIComponent(o)}catch(i){return a.readASCII(e,r,n)}return i}};function i(e,r,n,i){let o=r*n,s=Math.ceil(r*d(i)/8),l=new Uint8Array(4*o),u=new Uint32Array(l.buffer),{ctype:f}=i,{depth:c}=i,h=a.readUshort;if(6==f){let r=o<<2;if(8==c)for(var m=0;m<r;m+=4)l[m]=e[m],l[m+1]=e[m+1],l[m+2]=e[m+2],l[m+3]=e[m+3];if(16==c)for(m=0;m<r;m++)l[m]=e[m<<1]}else if(2==f){let r=i.tabs.tRNS;if(null==r){if(8==c)for(m=0;m<o;m++){var p=3*m;u[m]=-0x1000000|e[p+2]<<16|e[p+1]<<8|e[p]}if(16==c)for(m=0;m<o;m++)p=6*m,u[m]=-0x1000000|e[p+4]<<16|e[p+2]<<8|e[p]}else{var g=r[0];let n=r[1],a=r[2];if(8==c)for(m=0;m<o;m++){var b=m<<2;p=3*m,u[m]=-0x1000000|e[p+2]<<16|e[p+1]<<8|e[p],e[p]==g&&e[p+1]==n&&e[p+2]==a&&(l[b+3]=0)}if(16==c)for(m=0;m<o;m++)b=m<<2,p=6*m,u[m]=-0x1000000|e[p+4]<<16|e[p+2]<<8|e[p],h(e,p)==g&&h(e,p+2)==n&&h(e,p+4)==a&&(l[b+3]=0)}}else if(3==f){let a=i.tabs.PLTE,d=i.tabs.tRNS,u=d?d.length:0;if(1==c)for(var x,y=0;y<n;y++){var v=y*s,w=y*r;for(m=0;m<r;m++){b=w+m<<2;var A=3*(x=e[v+(m>>3)]>>7-(7&m)&1);l[b]=a[A],l[b+1]=a[A+1],l[b+2]=a[A+2],l[b+3]=x<u?d[x]:255}}if(2==c)for(y=0;y<n;y++)for(v=y*s,w=y*r,m=0;m<r;m++)b=w+m<<2,A=3*(x=e[v+(m>>2)]>>6-((3&m)<<1)&3),l[b]=a[A],l[b+1]=a[A+1],l[b+2]=a[A+2],l[b+3]=x<u?d[x]:255;if(4==c)for(y=0;y<n;y++)for(v=y*s,w=y*r,m=0;m<r;m++)b=w+m<<2,A=3*(x=e[v+(m>>1)]>>4-((1&m)<<2)&15),l[b]=a[A],l[b+1]=a[A+1],l[b+2]=a[A+2],l[b+3]=x<u?d[x]:255;if(8==c)for(m=0;m<o;m++)b=m<<2,A=3*(x=e[m]),l[b]=a[A],l[b+1]=a[A+1],l[b+2]=a[A+2],l[b+3]=x<u?d[x]:255}else if(4==f){if(8==c)for(m=0;m<o;m++){b=m<<2;var j,_=e[j=m<<1];l[b]=_,l[b+1]=_,l[b+2]=_,l[b+3]=e[j+1]}if(16==c)for(m=0;m<o;m++)b=m<<2,_=e[j=m<<2],l[b]=_,l[b+1]=_,l[b+2]=_,l[b+3]=e[j+2]}else if(0==f)for(g=i.tabs.tRNS?i.tabs.tRNS:-1,y=0;y<n;y++){let n=y*s,a=y*r;if(1==c)for(var N=0;N<r;N++){var E=255*((_=255*(e[n+(N>>>3)]>>>7-(7&N)&1))!=255*g);u[a+N]=E<<24|_<<16|_<<8|_}else if(2==c)for(N=0;N<r;N++)E=255*((_=85*(e[n+(N>>>2)]>>>6-((3&N)<<1)&3))!=85*g),u[a+N]=E<<24|_<<16|_<<8|_;else if(4==c)for(N=0;N<r;N++)E=255*((_=17*(e[n+(N>>>1)]>>>4-((1&N)<<2)&15))!=17*g),u[a+N]=E<<24|_<<16|_<<8|_;else if(8==c)for(N=0;N<r;N++)E=255*((_=e[n+N])!=g),u[a+N]=E<<24|_<<16|_<<8|_;else if(16==c)for(N=0;N<r;N++)_=e[n+(N<<1)],E=255*(h(e,n+(N<<1))!=g),u[a+N]=E<<24|_<<16|_<<8|_}return l}function o(e,r,n,a){let i=new Uint8Array((Math.ceil(n*d(e)/8)+1+e.interlace)*a);return r=e.tabs.CgBI?l(r,i):s(r,i),0==e.interlace?r=u(r,e,0,n,a):1==e.interlace&&(r=function(e,r){let n=r.width,a=r.height,i=d(r),o=i>>3,s=Math.ceil(n*i/8),l=new Uint8Array(a*s),f=0,c=[0,0,4,0,2,0,1],h=[0,4,0,2,0,1,0],m=[8,8,8,4,4,2,2],p=[8,8,4,4,2,2,1],g=0;for(;g<7;){let d=m[g],x=p[g],y=0,v=0,w=c[g];for(;w<a;)w+=d,v++;let A=h[g];for(;A<n;)A+=x,y++;let j=Math.ceil(y*i/8);u(e,r,f,y,v);let _=0,N=c[g];for(;N<a;){let r=h[g],a=f+_*j<<3;for(;r<n;){var b;if(1==i&&(b=(b=e[a>>3])>>7-(7&a)&1,l[N*s+(r>>3)]|=b<<7-(7&r)),2==i&&(b=(b=e[a>>3])>>6-(7&a)&3,l[N*s+(r>>2)]|=b<<6-((3&r)<<1)),4==i&&(b=(b=e[a>>3])>>4-(7&a)&15,l[N*s+(r>>1)]|=b<<4-((1&r)<<2)),i>=8){let n=N*s+r*o;for(let r=0;r<o;r++)l[n+r]=e[(a>>3)+r]}a+=i,r+=x}_++,N+=d}y*v!=0&&(f+=v*(1+j)),g+=1}return l}(r,e)),r}function s(e,r){return l(new Uint8Array(e.buffer,2,e.length-6),r)}var l=((e={}).N=function(r,n){let a=Uint8Array,i,o,s=0,l=0,d=0,u=0,f=0,c=0,h=0,m=0,p=0;if(3==r[0]&&0==r[1])return n||new a(0);let g=e.b,b=e.e,x=e.R,y=e.n,v=e.A,w=e.Z,A=e.m,j=null==n;for(j&&(n=new a(r.length>>>2<<5));0==s;)if(s=g(r,p,1),l=g(r,p+1,2),p+=3,0!=l){if(j&&(n=e.W(n,m+131072)),1==l&&(i=A.J,o=A.h,c=511,h=31),2==l){d=b(r,p,5)+257,u=b(r,p+5,5)+1,f=b(r,p+10,4)+4,p+=14;let n=1;for(var _=0;_<38;_+=2)A.Q[_]=0,A.Q[_+1]=0;for(_=0;_<f;_++){let e=b(r,p+3*_,3);A.Q[1+(A.X[_]<<1)]=e,e>n&&(n=e)}p+=3*f,y(A.Q,n),v(A.Q,n,A.u),i=A.w,o=A.d,p=x(A.u,(1<<n)-1,d+u,r,p,A.v);let a=e.V(A.v,0,d,A.C);c=(1<<a)-1;let s=e.V(A.v,d,u,A.D);h=(1<<s)-1,y(A.C,a),v(A.C,a,i),y(A.D,s),v(A.D,s,o)}for(;;){let e=i[w(r,p)&c];p+=15&e;let a=e>>>4;if(a>>>8==0)n[m++]=a;else{if(256==a)break;{let e=m+a-254;if(a>264){let n=A.q[a-257];e=m+(n>>>3)+b(r,p,7&n),p+=7&n}let i=o[w(r,p)&h];p+=15&i;let s=i>>>4,l=A.c[s],d=(l>>>4)+g(r,p,15&l);for(p+=15&l;m<e;)n[m]=n[m++-d],n[m]=n[m++-d],n[m]=n[m++-d],n[m]=n[m++-d];m=e}}}}else{0!=(7&p)&&(p+=8-(7&p));let i=4+(p>>>3),o=r[i-4]|r[i-3]<<8;j&&(n=e.W(n,m+o)),n.set(new a(r.buffer,r.byteOffset+i,o),m),p=i+o<<3,m+=o}return n.length==m?n:n.slice(0,m)},e.W=function(e,r){let n=e.length;if(r<=n)return e;let a=new Uint8Array(n<<1);return a.set(e,0),a},e.R=function(r,n,a,i,o,s){let l=e.e,d=e.Z,u=0;for(;u<a;){let e=r[d(i,o)&n];o+=15&e;let a=e>>>4;if(a<=15)s[u]=a,u++;else{let e=0,r=0;16==a?(r=3+l(i,o,2),o+=2,e=s[u-1]):17==a?(r=3+l(i,o,3),o+=3):18==a&&(r=11+l(i,o,7),o+=7);let n=u+r;for(;u<n;)s[u]=e,u++}}return o},e.V=function(e,r,n,a){let i=0,o=0,s=a.length>>>1;for(;o<n;){let n=e[o+r];a[o<<1]=0,a[1+(o<<1)]=n,n>i&&(i=n),o++}for(;o<s;)a[o<<1]=0,a[1+(o<<1)]=0,o++;return i},e.n=function(r,n){let a,i,o,s,l=e.m,d=r.length,u=l.j;for(var f=0;f<=n;f++)u[f]=0;for(f=1;f<d;f+=2)u[r[f]]++;let c=l.K;for(a=0,u[0]=0,i=1;i<=n;i++)a=a+u[i-1]<<1,c[i]=a;for(o=0;o<d;o+=2)0!=(s=r[o+1])&&(r[o]=c[s],c[s]++)},e.A=function(r,n,a){let i=r.length,o=e.m.r;for(let e=0;e<i;e+=2)if(0!=r[e+1]){let i=e>>1,s=r[e+1],l=i<<4|s,d=n-s,u=r[e]<<d,f=u+(1<<d);for(;u!=f;)a[o[u]>>>15-n]=l,u++}},e.l=function(r,n){let a=e.m.r,i=15-n;for(let e=0;e<r.length;e+=2){let o=r[e]<<n-r[e+1];r[e]=a[o]>>>i}},e.M=function(e,r,n){n<<=7&r;let a=r>>>3;e[a]|=n,e[a+1]|=n>>>8},e.I=function(e,r,n){n<<=7&r;let a=r>>>3;e[a]|=n,e[a+1]|=n>>>8,e[a+2]|=n>>>16},e.e=function(e,r,n){return(e[r>>>3]|e[1+(r>>>3)]<<8)>>>(7&r)&(1<<n)-1},e.b=function(e,r,n){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16)>>>(7&r)&(1<<n)-1},e.Z=function(e,r){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16)>>>(7&r)},e.i=function(e,r){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16|e[3+(r>>>3)]<<24)>>>(7&r)},r=Uint16Array,n=Uint32Array,e.m={K:new r(16),j:new r(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new r(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new n(32),J:new r(512),_:[],h:new r(32),$:[],w:new r(32768),C:[],v:[],d:new r(32768),D:[],u:new r(512),Q:[],r:new r(32768),s:new n(286),Y:new n(30),a:new n(19),t:new n(15e3),k:new r(65536),g:new r(32768)},function(){let r=e.m;for(var n=0;n<32768;n++){let e=n;e=(0xff00ff00&(e=(0xf0f0f0f0&(e=(0xcccccccc&(e=(0xaaaaaaaa&e)>>>1|(0x55555555&e)<<1))>>>2|(0x33333333&e)<<2))>>>4|(0xf0f0f0f&e)<<4))>>>8|(0xff00ff&e)<<8,r.r[n]=(e>>>16|e<<16)>>>17}function a(e,r,n){for(;0!=r--;)e.push(0,n)}for(n=0;n<32;n++)r.q[n]=r.S[n]<<3|r.T[n],r.c[n]=r.p[n]<<4|r.z[n];a(r._,144,8),a(r._,112,9),a(r._,24,7),a(r._,8,8),e.n(r._,9),e.A(r._,9,r.J),e.l(r._,9),a(r.$,32,5),e.n(r.$,5),e.A(r.$,5,r.h),e.l(r.$,5),a(r.Q,19,0),a(r.C,286,0),a(r.D,30,0),a(r.v,320,0)}(),e.N);function d(e){return[1,null,3,1,2,null,4][e.ctype]*e.depth}function u(e,r,n,a,i){let o,s,l=d(r),u=Math.ceil(a*l/8);l=Math.ceil(l/8);let c=e[n],h=0;if(c>1&&(e[n]=[0,0,1][c-2]),3==c)for(h=l;h<u;h++)e[h+1]=e[h+1]+(e[h+1-l]>>>1)&255;for(let r=0;r<i;r++)if(c=e[(s=(o=n+r*u)+r+1)-1],h=0,0==c)for(;h<u;h++)e[o+h]=e[s+h];else if(1==c){for(;h<l;h++)e[o+h]=e[s+h];for(;h<u;h++)e[o+h]=e[s+h]+e[o+h-l]}else if(2==c)for(;h<u;h++)e[o+h]=e[s+h]+e[o+h-u];else if(3==c){for(;h<l;h++)e[o+h]=e[s+h]+(e[o+h-u]>>>1);for(;h<u;h++)e[o+h]=e[s+h]+(e[o+h-u]+e[o+h-l]>>>1)}else{for(;h<l;h++)e[o+h]=e[s+h]+f(0,e[o+h-u],0);for(;h<u;h++)e[o+h]=e[s+h]+f(e[o+h-l],e[o+h-u],e[o+h-l-u])}return e}function f(e,r,n){let a=e+r-n,i=a-e,o=a-r,s=a-n;return i*i<=o*o&&i*i<=s*s?e:o*o<=s*s?r:n}function c(e,r,n,a,i,o,s,l,d){let u=Math.min(r,i),f=Math.min(n,o),c=0,h=0;for(let n=0;n<f;n++)for(let o=0;o<u;o++)if(s>=0&&l>=0?(c=n*r+o<<2,h=(l+n)*i+s+o<<2):(c=(-l+n)*r-s+o<<2,h=n*i+o<<2),0==d)a[h]=e[c],a[h+1]=e[c+1],a[h+2]=e[c+2],a[h+3]=e[c+3];else if(1==d){var m=e[c+3]*(1/255),p=e[c]*m,g=e[c+1]*m,b=e[c+2]*m,x=a[h+3]*(1/255),y=a[h]*x,v=a[h+1]*x,w=a[h+2]*x;let r=1-m,n=m+x*r,i=0==n?0:1/n;a[h+3]=255*n,a[h+0]=(p+y*r)*i,a[h+1]=(g+v*r)*i,a[h+2]=(b+w*r)*i}else if(2==d)m=e[c+3],p=e[c],g=e[c+1],b=e[c+2],x=a[h+3],y=a[h],v=a[h+1],w=a[h+2],m==x&&p==y&&g==v&&b==w?(a[h]=0,a[h+1]=0,a[h+2]=0,a[h+3]=0):(a[h]=p,a[h+1]=g,a[h+2]=b,a[h+3]=m);else if(3==d){if(m=e[c+3],p=e[c],g=e[c+1],b=e[c+2],x=a[h+3],y=a[h],v=a[h+1],w=a[h+2],m==x&&p==y&&g==v&&b==w)continue;if(m<220&&x>20)return!1}return!0}return{decode:function(e){let r=new Uint8Array(e),n=8,i=a.readUshort,d=a.readUint,u={tabs:{},frames:[]},f=new Uint8Array(r.length),c,h=0,m=0,p=[137,80,78,71,13,10,26,10];for(var g,b=0;b<8;b++)if(r[b]!=p[b])throw"The input is not a PNG file!";for(;n<r.length;){let e=a.readUint(r,n);n+=4;let p=a.readASCII(r,n,4);if(n+=4,"IHDR"==p)x=n,u.width=a.readUint(r,x),x+=4,u.height=a.readUint(r,x),u.depth=r[x+=4],u.ctype=r[++x],u.compress=r[++x],u.filter=r[++x],u.interlace=r[++x],x++;else if("iCCP"==p){for(var x,y,v=n;0!=r[v];)v++;a.readASCII(r,n,v-n),r[v+1];let i=r.slice(v+2,n+e),o=null;try{o=s(i)}catch(e){o=l(i)}u.tabs[p]=o}else if("CgBI"==p)u.tabs[p]=r.slice(n,n+4);else if("IDAT"==p){for(b=0;b<e;b++)f[h+b]=r[n+b];h+=e}else if("acTL"==p)u.tabs[p]={num_frames:d(r,n),num_plays:d(r,n+4)},c=new Uint8Array(r.length);else if("fcTL"==p){0!=m&&((g=u.frames[u.frames.length-1]).data=o(u,c.slice(0,m),g.rect.width,g.rect.height),m=0);let e={x:d(r,n+12),y:d(r,n+16),width:d(r,n+4),height:d(r,n+8)},a=i(r,n+22),s={rect:e,delay:Math.round(1e3*(a=i(r,n+20)/(0==a?100:a))),dispose:r[n+24],blend:r[n+25]};u.frames.push(s)}else if("fdAT"==p){for(b=0;b<e-4;b++)c[m+b]=r[n+b+4];m+=e-4}else if("pHYs"==p)u.tabs[p]=[a.readUint(r,n),a.readUint(r,n+4),r[n+8]];else if("cHRM"==p)for(b=0,u.tabs[p]=[];b<8;b++)u.tabs[p].push(a.readUint(r,n+4*b));else if("tEXt"==p||"zTXt"==p){null==u.tabs[p]&&(u.tabs[p]={});var w=a.nextZero(r,n),A=a.readASCII(r,n,w-n),j=n+e-w-1;if("tEXt"==p)y=a.readASCII(r,w+1,j);else{var _=s(r.slice(w+2,w+2+j));y=a.readUTF8(_,0,_.length)}u.tabs[p][A]=y}else if("iTXt"==p){null==u.tabs[p]&&(u.tabs[p]={}),w=0,v=n,w=a.nextZero(r,v),A=a.readASCII(r,v,w-v);let i=r[v=w+1];r[v+1],v+=2,w=a.nextZero(r,v),a.readASCII(r,v,w-v),v=w+1,w=a.nextZero(r,v),a.readUTF8(r,v,w-v),j=e-((v=w+1)-n),0==i?y=a.readUTF8(r,v,j):(_=s(r.slice(v,v+j)),y=a.readUTF8(_,0,_.length)),u.tabs[p][A]=y}else if("PLTE"==p)u.tabs[p]=a.readBytes(r,n,e);else if("hIST"==p){let e=u.tabs.PLTE.length/3;for(b=0,u.tabs[p]=[];b<e;b++)u.tabs[p].push(i(r,n+2*b))}else if("tRNS"==p)3==u.ctype?u.tabs[p]=a.readBytes(r,n,e):0==u.ctype?u.tabs[p]=i(r,n):2==u.ctype&&(u.tabs[p]=[i(r,n),i(r,n+2),i(r,n+4)]);else if("gAMA"==p)u.tabs[p]=a.readUint(r,n)/1e5;else if("sRGB"==p)u.tabs[p]=r[n];else if("bKGD"==p)0==u.ctype||4==u.ctype?u.tabs[p]=[i(r,n)]:2==u.ctype||6==u.ctype?u.tabs[p]=[i(r,n),i(r,n+2),i(r,n+4)]:3==u.ctype&&(u.tabs[p]=r[n]);else if("IEND"==p)break;n+=e,a.readUint(r,n),n+=4}return 0!=m&&((g=u.frames[u.frames.length-1]).data=o(u,c.slice(0,m),g.rect.width,g.rect.height)),u.data=o(u,f,u.width,u.height),delete u.compress,delete u.interlace,delete u.filter,u},toRGBA8:function(e){let r=e.width,n=e.height;if(null==e.tabs.acTL)return[i(e.data,r,n,e).buffer];let a=[];null==e.frames[0].data&&(e.frames[0].data=e.data);let o=r*n*4,s=new Uint8Array(o),l=new Uint8Array(o),d=new Uint8Array(o);for(let f=0;f<e.frames.length;f++){let h=e.frames[f],m=h.rect.x,p=h.rect.y,g=h.rect.width,b=h.rect.height,x=i(h.data,g,b,e);if(0!=f)for(var u=0;u<o;u++)d[u]=s[u];if(0==h.blend?c(x,g,b,s,r,n,m,p,0):1==h.blend&&c(x,g,b,s,r,n,m,p,1),a.push(s.buffer.slice(0)),0==h.dispose);else if(1==h.dispose)c(l,g,b,s,r,n,m,p,0);else if(2==h.dispose)for(u=0;u<o;u++)s[u]=d[u]}return a},_paeth:f,_copyTile:c,_bin:a}}();!function(){let{_copyTile:e}=eb,{_bin:r}=eb,n=eb._paeth;var a={table:function(){let e=new Uint32Array(256);for(let r=0;r<256;r++){let n=r;for(let e=0;e<8;e++)1&n?n=0xedb88320^n>>>1:n>>>=1;e[r]=n}return e}(),update(e,r,n,i){for(let o=0;o<i;o++)e=a.table[255&(e^r[n+o])]^e>>>8;return e},crc:(e,r,n)=>0xffffffff^a.update(0xffffffff,e,r,n)};function i(e,r,n,a){r[n]+=e[0]*a>>4,r[n+1]+=e[1]*a>>4,r[n+2]+=e[2]*a>>4,r[n+3]+=e[3]*a>>4}function o(e){return Math.max(0,Math.min(255,e))}function s(e,r){let n=e[0]-r[0],a=e[1]-r[1],i=e[2]-r[2],o=e[3]-r[3];return n*n+a*a+i*i+o*o}function l(e,r,n,a,l,d,u){null==u&&(u=1);let f=a.length,c=[];for(var h,m=0;m<f;m++){let e=a[m];c.push([e>>>0&255,e>>>8&255,e>>>16&255,e>>>24&255])}for(m=0;m<f;m++){let e=0xffffffff;for(var p=0,g=0;g<f;g++){var b=s(c[m],c[g]);g!=m&&b<e&&(e=b,p=g)}}let x=new Uint32Array(l.buffer),y=new Int16Array(r*n*4),v=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5];for(m=0;m<v.length;m++)v[m]=255*((v[m]+.5)/16-.5);for(let l=0;l<n;l++)for(let w=0;w<r;w++){m=4*(l*r+w),2!=u?h=[o(e[m]+y[m]),o(e[m+1]+y[m+1]),o(e[m+2]+y[m+2]),o(e[m+3]+y[m+3])]:(b=v[4*(3&l)+(3&w)],h=[o(e[m]+b),o(e[m+1]+b),o(e[m+2]+b),o(e[m+3]+b)]),p=0;let A=0xffffff;for(g=0;g<f;g++){let e=s(h,c[g]);e<A&&(A=e,p=g)}let j=c[p],_=[h[0]-j[0],h[1]-j[1],h[2]-j[2],h[3]-j[3]];1==u&&(w!=r-1&&i(_,y,m+4,7),l!=n-1&&(0!=w&&i(_,y,m+4*r-4,3),i(_,y,m+4*r,5),w!=r-1&&i(_,y,m+4*r+4,1))),d[m>>2]=p,x[m>>2]=a[p]}}function d(e,n,i,o,s){null==s&&(s={});let{crc:l}=a,d=r.writeUint,u=r.writeUshort,f=r.writeASCII,c=8,h=e.frames.length>1,m,p=!1,g=33+20*!!h;if(null!=s.sRGB&&(g+=13),null!=s.pHYs&&(g+=21),null!=s.iCCP&&(g+=21+(m=pako.deflate(s.iCCP)).length+4),3==e.ctype){for(var b=e.plte.length,x=0;x<b;x++)e.plte[x]>>>24!=255&&(p=!0);g+=8+3*b+4+(p?8+ +b+4:0)}for(var y=0;y<e.frames.length;y++)h&&(g+=38),g+=(j=e.frames[y]).cimg.length+12,0!=y&&(g+=4);let v=new Uint8Array(g+=12),w=[137,80,78,71,13,10,26,10];for(x=0;x<8;x++)v[x]=w[x];if(d(v,c,13),f(v,c+=4,"IHDR"),d(v,c+=4,n),d(v,c+=4,i),v[c+=4]=e.depth,v[++c]=e.ctype,v[++c]=0,v[++c]=0,v[++c]=0,d(v,++c,l(v,c-17,17)),c+=4,null!=s.sRGB&&(d(v,c,1),f(v,c+=4,"sRGB"),v[c+=4]=s.sRGB,d(v,++c,l(v,c-5,5)),c+=4),null!=s.iCCP){let e=13+m.length;d(v,c,e),f(v,c+=4,"iCCP"),f(v,c+=4,"ICC profile"),c+=11,c+=2,v.set(m,c),d(v,c+=m.length,l(v,c-(e+4),e+4)),c+=4}if(null!=s.pHYs&&(d(v,c,9),f(v,c+=4,"pHYs"),d(v,c+=4,s.pHYs[0]),d(v,c+=4,s.pHYs[1]),v[c+=4]=s.pHYs[2],d(v,++c,l(v,c-13,13)),c+=4),h&&(d(v,c,8),f(v,c+=4,"acTL"),d(v,c+=4,e.frames.length),d(v,c+=4,null!=s.loop?s.loop:0),d(v,c+=4,l(v,c-12,12)),c+=4),3==e.ctype){for(d(v,c,3*(b=e.plte.length)),f(v,c+=4,"PLTE"),c+=4,x=0;x<b;x++){let r=3*x,n=e.plte[x],a=255&n,i=n>>>8&255,o=n>>>16&255;v[c+r+0]=a,v[c+r+1]=i,v[c+r+2]=o}if(d(v,c+=3*b,l(v,c-3*b-4,3*b+4)),c+=4,p){for(d(v,c,b),f(v,c+=4,"tRNS"),c+=4,x=0;x<b;x++)v[c+x]=e.plte[x]>>>24&255;d(v,c+=b,l(v,c-b-4,b+4)),c+=4}}let A=0;for(y=0;y<e.frames.length;y++){var j=e.frames[y];h&&(d(v,c,26),f(v,c+=4,"fcTL"),d(v,c+=4,A++),d(v,c+=4,j.rect.width),d(v,c+=4,j.rect.height),d(v,c+=4,j.rect.x),d(v,c+=4,j.rect.y),u(v,c+=4,o[y]),u(v,c+=2,1e3),v[c+=2]=j.dispose,v[++c]=j.blend,d(v,++c,l(v,c-30,30)),c+=4);let r=j.cimg;d(v,c,(b=r.length)+4*(0!=y));let n=c+=4;f(v,c,0==y?"IDAT":"fdAT"),c+=4,0!=y&&(d(v,c,A++),c+=4),v.set(r,c),d(v,c+=b,l(v,n,c-n)),c+=4}return d(v,c,0),f(v,c+=4,"IEND"),d(v,c+=4,l(v,c-4,4)),c+=4,v.buffer}function u(e,r,a){for(let i=0;i<e.frames.length;i++){let o=e.frames[i];o.rect.width;let s=o.rect.height,l=new Uint8Array(s*o.bpl+s);o.cimg=function(e,r,a,i,o,s,l){let d=[],u,f=[0,1,2,3,4];-1!=s?f=[s]:(r*i>5e5||1==a)&&(f=[0]),l&&(u={level:0});for(var c=0;c<f.length;c++){for(let s=0;s<r;s++)!function(e,r,a,i,o,s){let l=a*i,d=l+a;if(e[d]=s,d++,0==s)if(i<500)for(var u=0;u<i;u++)e[d+u]=r[l+u];else e.set(new Uint8Array(r.buffer,l,i),d);else if(1==s){for(u=0;u<o;u++)e[d+u]=r[l+u];for(u=o;u<i;u++)e[d+u]=r[l+u]-r[l+u-o]+256&255}else if(0==a){for(u=0;u<o;u++)e[d+u]=r[l+u];if(2==s)for(u=o;u<i;u++)e[d+u]=r[l+u];if(3==s)for(u=o;u<i;u++)e[d+u]=r[l+u]-(r[l+u-o]>>1)+256&255;if(4==s)for(u=o;u<i;u++)e[d+u]=r[l+u]-n(r[l+u-o],0,0)+256&255}else{if(2==s)for(u=0;u<i;u++)e[d+u]=r[l+u]+256-r[l+u-i]&255;if(3==s){for(u=0;u<o;u++)e[d+u]=r[l+u]+256-(r[l+u-i]>>1)&255;for(u=o;u<i;u++)e[d+u]=r[l+u]+256-(r[l+u-i]+r[l+u-o]>>1)&255}if(4==s){for(u=0;u<o;u++)e[d+u]=r[l+u]+256-n(0,r[l+u-i],0)&255;for(u=o;u<i;u++)e[d+u]=r[l+u]+256-n(r[l+u-o],r[l+u-i],r[l+u-o-i])&255}}}(o,e,s,i,a,f[c]);d.push(eg.deflate(o,u))}let h,m=1e9;for(c=0;c<d.length;c++)d[c].length<m&&(h=c,m=d[c].length);return d[h]}(o.img,s,o.bpp,o.bpl,l,r,a)}}function f(r,n,a,i,o){let s=o[0],d=o[1],u=o[2],f=o[3],p=o[4],g=o[5],b=6,x=8,y=255;for(var v=0;v<r.length;v++){let e=new Uint8Array(r[v]);for(var w=e.length,A=0;A<w;A+=4)y&=e[A+3]}let j=255!=y,_=function(r,n,a,i,o,s){let l=[];for(var d,u=0;u<r.length;u++){let d=new Uint8Array(r[u]),c=new Uint32Array(d.buffer),g=0,b=0,x=n,y=a,v=+!!i;if(0!=u){let w=s||i||1==u||0!=l[u-2].dispose?1:2,A=0,j=1e9;for(let e=0;e<w;e++){var f,m=new Uint8Array(r[u-1-e]);let i=new Uint32Array(r[u-1-e]),s=n,l=a,d=-1,h=-1;for(let e=0;e<a;e++)for(let r=0;r<n;r++)c[p=e*n+r]!=i[p]&&(r<s&&(s=r),r>d&&(d=r),e<l&&(l=e),e>h&&(h=e));-1==d&&(s=l=d=h=0),o&&(1==(1&s)&&s--,1==(1&l)&&l--);let v=(d-s+1)*(h-l+1);v<j&&(j=v,A=e,g=s,b=l,x=d-s+1,y=h-l+1)}m=new Uint8Array(r[u-1-A]),1==A&&(l[u-1].dispose=2),e(m,n,a,f=new Uint8Array(x*y*4),x,y,-g,-b,0),1==(v=+!!e(d,n,a,f,x,y,-g,-b,3))?h(d,n,a,f,{x:g,y:b,width:x,height:y}):e(d,n,a,f,x,y,-g,-b,0)}else f=d.slice(0);l.push({rect:{x:g,y:b,width:x,height:y},img:f,blend:v,dispose:0})}if(i)for(u=0;u<l.length;u++){if(1==(d=l[u]).blend)continue;let e=d.rect,i=l[u-1].rect,s=Math.min(e.x,i.x),f=Math.min(e.y,i.y),h={x:s,y:f,width:Math.max(e.x+e.width,i.x+i.width)-s,height:Math.max(e.y+e.height,i.y+i.height)-f};l[u-1].dispose=1,u-1!=0&&c(r,n,a,l,u-1,h,o),c(r,n,a,l,u,h,o)}if(1!=r.length)for(var p=0;p<l.length;p++)(d=l[p]).rect.width,d.rect.height;return l}(r,n,a,s,d,u),N={},E=[],U=[];if(0!=i){let e=[];for(A=0;A<_.length;A++)e.push(_[A].img.buffer);let r=m(function(e){let r=0;for(var n=0;n<e.length;n++)r+=e[n].byteLength;let a=new Uint8Array(r),i=0;for(n=0;n<e.length;n++){let r=new Uint8Array(e[n]),o=r.length;for(let e=0;e<o;e+=4){let n=r[e],o=r[e+1],s=r[e+2],l=r[e+3];0==l&&(n=o=s=0),a[i+e]=n,a[i+e+1]=o,a[i+e+2]=s,a[i+e+3]=l}i+=o}return a.buffer}(e),i);for(A=0;A<r.plte.length;A++)E.push(r.plte[A].est.rgba);let n=0;for(A=0;A<_.length;A++){let e=(F=_[A]).img.length;var k=new Uint8Array(r.inds.buffer,n>>2,e>>2);U.push(k);let a=new Uint8Array(r.abuf,n,e);g&&l(F.img,F.rect.width,F.rect.height,E,a,k),F.img.set(a),n+=e}}else for(v=0;v<_.length;v++){var F=_[v];let e=new Uint32Array(F.img.buffer);var C=F.rect.width;for(k=new Uint8Array(w=e.length),U.push(k),A=0;A<w;A++){let r=e[A];if(0!=A&&r==e[A-1])k[A]=k[A-1];else if(A>C&&r==e[A-C])k[A]=k[A-C];else{let e=N[r];if(null==e&&(N[r]=e=E.length,E.push(r),E.length>=300))break;k[A]=e}}}let M=E.length;for(M<=256&&0==p&&(x=Math.max(x=M<=2?1:M<=4?2:M<=16?4:8,f)),v=0;v<_.length;v++){(F=_[v]).rect.x,F.rect.y,C=F.rect.width;let e=F.rect.height,r=F.img;new Uint32Array(r.buffer);let n=4*C,a=4;if(M<=256&&0==p){var S=new Uint8Array((n=Math.ceil(x*C/8))*e);let i=U[v];for(let r=0;r<e;r++){A=r*n;let e=r*C;if(8==x)for(var L=0;L<C;L++)S[A+L]=i[e+L];else if(4==x)for(L=0;L<C;L++)S[A+(L>>1)]|=i[e+L]<<4-4*(1&L);else if(2==x)for(L=0;L<C;L++)S[A+(L>>2)]|=i[e+L]<<6-2*(3&L);else if(1==x)for(L=0;L<C;L++)S[A+(L>>3)]|=i[e+L]<<7-(7&L)}r=S,b=3,a=1}else if(0==j&&1==_.length){S=new Uint8Array(C*e*3);let i=C*e;for(A=0;A<i;A++){let e=3*A,n=4*A;S[e]=r[n],S[e+1]=r[n+1],S[e+2]=r[n+2]}r=S,b=2,a=3,n=3*C}F.img=r,F.bpl=n,F.bpp=a}return{ctype:b,depth:x,plte:E,frames:_}}function c(r,n,a,i,o,s,l){let d=Uint8Array,u=Uint32Array,f=new d(r[o-1]),c=new u(r[o-1]),m=o+1<r.length?new d(r[o+1]):null,p=new d(r[o]),g=new u(p.buffer),b=n,x=a,y=-1,v=-1;for(let e=0;e<s.height;e++)for(let r=0;r<s.width;r++){let a=s.x+r,l=s.y+e,d=l*n+a,u=g[d];0==u||0==i[o-1].dispose&&c[d]==u&&(null==m||0!=m[4*d+3])||(a<b&&(b=a),a>y&&(y=a),l<x&&(x=l),l>v&&(v=l))}-1==y&&(b=x=y=v=0),l&&(1==(1&b)&&b--,1==(1&x)&&x--),s={x:b,y:x,width:y-b+1,height:v-x+1};let w=i[o];w.rect=s,w.blend=1,w.img=new Uint8Array(s.width*s.height*4),0==i[o-1].dispose?(e(f,n,a,w.img,s.width,s.height,-s.x,-s.y,0),h(p,n,a,w.img,s)):e(p,n,a,w.img,s.width,s.height,-s.x,-s.y,0)}function h(r,n,a,i,o){e(r,n,a,i,o.width,o.height,-o.x,-o.y,2)}function m(e,r){let n,a=new Uint8Array(e),i=a.slice(0),o=new Uint32Array(i.buffer),s=p(i,r),l=s[0],d=s[1],u=a.length,f=new Uint8Array(u>>2);if(a.length<2e7)for(var c=0;c<u;c+=4)n=g(l,h=a[c]*(1/255),m=a[c+1]*(1/255),x=a[c+2]*(1/255),y=a[c+3]*(1/255)),f[c>>2]=n.ind,o[c>>2]=n.est.rgba;else for(c=0;c<u;c+=4){var h=a[c]*(1/255),m=a[c+1]*(1/255),x=a[c+2]*(1/255),y=a[c+3]*(1/255);for(n=l;n.left;)n=0>=b(n.est,h,m,x,y)?n.left:n.right;f[c>>2]=n.ind,o[c>>2]=n.est.rgba}return{abuf:i.buffer,inds:f,plte:d}}function p(e,r,n){null==n&&(n=1e-4);let a=new Uint32Array(e.buffer),i={i0:0,i1:e.length,bst:null,est:null,tdst:0,left:null,right:null};i.bst=y(e,i.i0,i.i1),i.est=v(i.bst);let o=[i];for(;o.length<r;){let r=0,i=0;for(var s=0;s<o.length;s++)o[s].est.L>r&&(r=o[s].est.L,i=s);if(r<n)break;let l=o[i],d=function(e,r,n,a,i,o){for(a-=4;n<a;){for(;x(e,n,i)<=o;)n+=4;for(;x(e,a,i)>o;)a-=4;if(n>=a)break;let s=r[n>>2];r[n>>2]=r[a>>2],r[a>>2]=s,n+=4,a-=4}for(;x(e,n,i)>o;)n-=4;return n+4}(e,a,l.i0,l.i1,l.est.e,l.est.eMq255);if(l.i0>=d||l.i1<=d){l.est.L=0;continue}let u={i0:l.i0,i1:d,bst:null,est:null,tdst:0,left:null,right:null};u.bst=y(e,u.i0,u.i1),u.est=v(u.bst);let f={i0:d,i1:l.i1,bst:null,est:null,tdst:0,left:null,right:null};for(s=0,f.bst={R:[],m:[],N:l.bst.N-u.bst.N};s<16;s++)f.bst.R[s]=l.bst.R[s]-u.bst.R[s];for(s=0;s<4;s++)f.bst.m[s]=l.bst.m[s]-u.bst.m[s];f.est=v(f.bst),l.left=u,l.right=f,o[i]=u,o.push(f)}for(o.sort((e,r)=>r.bst.N-e.bst.N),s=0;s<o.length;s++)o[s].ind=s;return[i,o]}function g(e,r,n,a,i){if(null==e.left){var o;let s,l,d,u;return o=e.est.q,s=r-o[0],l=n-o[1],d=a-o[2],e.tdst=s*s+l*l+d*d+(u=i-o[3])*u,e}let s=b(e.est,r,n,a,i),l=e.left,d=e.right;s>0&&(l=e.right,d=e.left);let u=g(l,r,n,a,i);if(u.tdst<=s*s)return u;let f=g(d,r,n,a,i);return f.tdst<u.tdst?f:u}function b(e,r,n,a,i){let{e:o}=e;return o[0]*r+o[1]*n+o[2]*a+o[3]*i-e.eMq}function x(e,r,n){return e[r]*n[0]+e[r+1]*n[1]+e[r+2]*n[2]+e[r+3]*n[3]}function y(e,r,n){let a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i=[0,0,0,0];for(let o=r;o<n;o+=4){let r=e[o]*(1/255),n=e[o+1]*(1/255),s=e[o+2]*(1/255),l=e[o+3]*(1/255);i[0]+=r,i[1]+=n,i[2]+=s,i[3]+=l,a[0]+=r*r,a[1]+=r*n,a[2]+=r*s,a[3]+=r*l,a[5]+=n*n,a[6]+=n*s,a[7]+=n*l,a[10]+=s*s,a[11]+=s*l,a[15]+=l*l}return a[4]=a[1],a[8]=a[2],a[9]=a[6],a[12]=a[3],a[13]=a[7],a[14]=a[11],{R:a,m:i,N:n-r>>2}}function v(e){let{R:r}=e,{m:n}=e,{N:a}=e,i=n[0],o=n[1],s=n[2],l=n[3],d=0==a?0:1/a,u=[r[0]-i*i*d,r[1]-i*o*d,r[2]-i*s*d,r[3]-i*l*d,r[4]-o*i*d,r[5]-o*o*d,r[6]-o*s*d,r[7]-o*l*d,r[8]-s*i*d,r[9]-s*o*d,r[10]-s*s*d,r[11]-s*l*d,r[12]-l*i*d,r[13]-l*o*d,r[14]-l*s*d,r[15]-l*l*d],f=[Math.random(),Math.random(),Math.random(),Math.random()],c=0,h=0;if(0!=a)for(let e=0;e<16&&(f=w.multVec(u,f),h=Math.sqrt(w.dot(f,f)),f=w.sml(1/h,f),!(0!=e&&1e-9>Math.abs(h-c)));e++)c=h;let m=[i*d,o*d,s*d,l*d];return{Cov:u,q:m,e:f,L:c,eMq255:w.dot(w.sml(255,m),f),eMq:w.dot(f,m),rgba:(Math.round(255*m[3])<<24|Math.round(255*m[2])<<16|Math.round(255*m[1])<<8|(0|Math.round(255*m[0])))>>>0}}var w={multVec:(e,r)=>[e[0]*r[0]+e[1]*r[1]+e[2]*r[2]+e[3]*r[3],e[4]*r[0]+e[5]*r[1]+e[6]*r[2]+e[7]*r[3],e[8]*r[0]+e[9]*r[1]+e[10]*r[2]+e[11]*r[3],e[12]*r[0]+e[13]*r[1]+e[14]*r[2]+e[15]*r[3]],dot:(e,r)=>e[0]*r[0]+e[1]*r[1]+e[2]*r[2]+e[3]*r[3],sml:(e,r)=>[e*r[0],e*r[1],e*r[2],e*r[3]]};eb.encode=function(e,r,n,a,i,o,s){null==a&&(a=0),null==s&&(s=!1);let l=f(e,r,n,a,[!1,!1,!1,0,s,!1]);return u(l,-1),d(l,r,n,i,o)},eb.encodeLL=function(e,r,n,a,i,o,s,l){let f={ctype:0+2*(1!=a)+4*(0!=i),depth:o,frames:[]},c=(a+i)*o,h=c*r;for(let a=0;a<e.length;a++)f.frames.push({rect:{x:0,y:0,width:r,height:n},img:new Uint8Array(e[a]),blend:0,dispose:1,bpp:Math.ceil(c/8),bpl:Math.ceil(h/8)});return u(f,0,!0),d(f,r,n,s,l)},eb.encode.compress=f,eb.encode.dither=l,eb.quantize=m,eb.quantize.getKDtree=p,eb.quantize.getNearest=g}();let ex={toArrayBuffer(e,r){let n=e.width,a=e.height,i=n<<2,o=new Uint32Array(e.getContext("2d").getImageData(0,0,n,a).data.buffer),s=(32*n+31)/32<<2,l=s*a,d=122+l,u=new ArrayBuffer(d),f=new DataView(u),c,h,m,p,g=1048576,b=0,x=0,y=0;function v(e){f.setUint16(x,e,!0),x+=2}function w(e){f.setUint32(x,e,!0),x+=4}v(19778),w(d),x+=4,w(122),w(108),w(n),w(-a>>>0),v(1),v(32),w(3),w(l),w(2835),w(2835),x+=8,w(0xff0000),w(65280),w(255),w(0xff000000),w(0x57696e20),function e(){for(;b<a&&g>0;){for(p=122+b*s,c=0;c<i;)g--,m=(h=o[y++])>>>24,f.setUint32(p+c,h<<8|m),c+=4;b++}y<o.length?(g=1048576,setTimeout(e,ex._dly)):r(u)}()},toBlob(e,r){this.toArrayBuffer(e,e=>{r(new Blob([e],{type:"image/bmp"}))})},_dly:9};var ey={CHROME:"CHROME",FIREFOX:"FIREFOX",DESKTOP_SAFARI:"DESKTOP_SAFARI",IE:"IE",IOS:"IOS",ETC:"ETC"},ev={[ey.CHROME]:16384,[ey.FIREFOX]:11180,[ey.DESKTOP_SAFARI]:16384,[ey.IE]:8192,[ey.IOS]:4096,[ey.ETC]:8192};let ew="undefined"!=typeof window,eA="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,ej=ew&&window.cordova&&window.cordova.require&&window.cordova.require("cordova/modulemapper"),e_=(ew||eA)&&(ej&&ej.getOriginalSymbol(window,"File")||"undefined"!=typeof File&&File),eN=(ew||eA)&&(ej&&ej.getOriginalSymbol(window,"FileReader")||"undefined"!=typeof FileReader&&FileReader);function eE(e,r,n=Date.now()){return new Promise(a=>{let i=e.split(","),o=i[0].match(/:(.*?);/)[1],s=globalThis.atob(i[1]),l=s.length,d=new Uint8Array(l);for(;l--;)d[l]=s.charCodeAt(l);let u=new Blob([d],{type:o});u.name=r,u.lastModified=n,a(u)})}function eU(e){return new Promise((r,n)=>{let a=new eN;a.onload=()=>r(a.result),a.onerror=e=>n(e),a.readAsDataURL(e)})}function ek(e){return new Promise((r,n)=>{let a=new Image;a.onload=()=>r(a),a.onerror=e=>n(e),a.src=e})}function eF(){if(void 0!==eF.cachedResult)return eF.cachedResult;let e=ey.ETC,{userAgent:r}=navigator;return/Chrom(e|ium)/i.test(r)?e=ey.CHROME:/iP(ad|od|hone)/i.test(r)&&/WebKit/i.test(r)?e=ey.IOS:/Safari/i.test(r)?e=ey.DESKTOP_SAFARI:/Firefox/i.test(r)?e=ey.FIREFOX:(/MSIE/i.test(r)||!0==!!document.documentMode)&&(e=ey.IE),eF.cachedResult=e,eF.cachedResult}function eC(e,r){let n=ev[eF()],a=e,i=r,o=a*i,s=a>i?i/a:a/i;for(;o>n*n;){let e=(n+a)/2,r=(n+i)/2;e<r?(i=r,a=r*s):(i=e*s,a=e),o=a*i}return{width:a,height:i}}function eM(e,r){let n,a;try{if(a=(n=new OffscreenCanvas(e,r)).getContext("2d"),null===a)throw Error("getContext of OffscreenCanvas returns null")}catch(e){a=(n=document.createElement("canvas")).getContext("2d")}return n.width=e,n.height=r,[n,a]}function eS(e,r){let{width:n,height:a}=eC(e.width,e.height),[i,o]=eM(n,a);return r&&/jpe?g/.test(r)&&(o.fillStyle="white",o.fillRect(0,0,i.width,i.height)),o.drawImage(e,0,0,i.width,i.height),i}function eL(){return void 0!==eL.cachedResult||(eL.cachedResult=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"undefined"!=typeof document&&"ontouchend"in document),eL.cachedResult}function eR(e,r={}){return new Promise(function(n,a){let i,o;var s=function(){try{return o=eS(i,r.fileType||e.type),n([i,o])}catch(e){return a(e)}},l=function(r){try{var n=function(e){try{throw e}catch(e){return a(e)}};try{let r;return eU(e).then(function(e){try{return r=e,ek(r).then(function(e){try{return i=e,function(){try{return s()}catch(e){return a(e)}}()}catch(e){return n(e)}},n)}catch(e){return n(e)}},n)}catch(e){n(e)}}catch(e){return a(e)}};try{if(eL()||[ey.DESKTOP_SAFARI,ey.MOBILE_SAFARI].includes(eF()))throw Error("Skip createImageBitmap on IOS and Safari");return createImageBitmap(e).then(function(e){try{return i=e,s()}catch(e){return l()}},l)}catch(e){l()}})}function eT(e,r,n,a,i=1){return new Promise(function(o,s){let l;if("image/png"===r){let o,s;return o=e.getContext("2d"),{data:s}=o.getImageData(0,0,e.width,e.height),(l=new Blob([eb.encode([s.buffer],e.width,e.height,4096*i)],{type:r})).name=n,l.lastModified=a,f.call(this)}if("image/bmp"===r)return new Promise(r=>ex.toBlob(e,r)).then((function(e){try{return(l=e).name=n,l.lastModified=a,u.call(this)}catch(e){return s(e)}}).bind(this),s);if("function"==typeof OffscreenCanvas&&e instanceof OffscreenCanvas)return e.convertToBlob({type:r,quality:i}).then((function(e){try{return(l=e).name=n,l.lastModified=a,d.call(this)}catch(e){return s(e)}}).bind(this),s);return eE(e.toDataURL(r,i),n,a).then((function(e){try{return l=e,d.call(this)}catch(e){return s(e)}}).bind(this),s);function d(){return u.call(this)}function u(){return f.call(this)}function f(){return o(l)}})}function eI(e){e.width=0,e.height=0}function ez(){return new Promise(function(e,r){let n,a,i,o;return void 0!==ez.cachedResult?e(ez.cachedResult):eE("data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==","test.jpg",Date.now()).then(function(s){try{return n=s,eR(n).then(function(s){try{return a=s[1],eT(a,n.type,n.name,n.lastModified).then(function(n){try{return i=n,eI(a),eR(i).then(function(n){try{return o=n[0],ez.cachedResult=1===o.width&&2===o.height,e(ez.cachedResult)}catch(e){return r(e)}},r)}catch(e){return r(e)}},r)}catch(e){return r(e)}},r)}catch(e){return r(e)}},r)})}function eB(e){return new Promise((r,n)=>{let a=new eN;a.onload=e=>{let n=new DataView(e.target.result);if(65496!=n.getUint16(0,!1))return r(-2);let a=n.byteLength,i=2;for(;i<a&&!(8>=n.getUint16(i+2,!1));){let e=n.getUint16(i,!1);if(i+=2,65505==e){if(0x45786966!=n.getUint32(i+=2,!1))return r(-1);let e=18761==n.getUint16(i+=6,!1);i+=n.getUint32(i+4,e);let a=n.getUint16(i,e);i+=2;for(let o=0;o<a;o++)if(274==n.getUint16(i+12*o,e))return r(n.getUint16(i+12*o+8,e))}else{if(65280!=(65280&e))break;i+=n.getUint16(i,!1)}}return r(-1)},a.onerror=e=>n(e),a.readAsArrayBuffer(e)})}function eP(e,r){let{width:n}=e,{height:a}=e,{maxWidthOrHeight:i}=r,o,s=e;return isFinite(i)&&(n>i||a>i)&&([s,o]=eM(n,a),n>a?(s.width=i,s.height=a/n*i):(s.width=n/a*i,s.height=i),o.drawImage(e,0,0,s.width,s.height),eI(e)),s}function eO(e,r){let{width:n}=e,{height:a}=e,[i,o]=eM(n,a);switch(r>4&&r<9?(i.width=a,i.height=n):(i.width=n,i.height=a),r){case 2:o.transform(-1,0,0,1,n,0);break;case 3:o.transform(-1,0,0,-1,n,a);break;case 4:o.transform(1,0,0,-1,0,a);break;case 5:o.transform(0,1,1,0,0,0);break;case 6:o.transform(0,1,-1,0,a,0);break;case 7:o.transform(0,-1,-1,0,a,n);break;case 8:o.transform(0,-1,1,0,0,n)}return o.drawImage(e,0,0,n,a),eI(e),i}function eD(e,r,n=0){return new Promise(function(a,i){let o,s,l,d,u,f,c,h,m,p,g,b,x,y,v,w,A,j,_,N;function E(e=5){if(r.signal&&r.signal.aborted)throw r.signal.reason;o+=e,r.onProgress(Math.min(o,100))}function U(e){if(r.signal&&r.signal.aborted)throw r.signal.reason;o=Math.min(Math.max(e,o),100),r.onProgress(o)}return o=n,s=r.maxIteration||10,l=1024*r.maxSizeMB*1024,E(),eR(e,r).then((function(n){try{return[,d]=n,E(),u=eP(d,r),E(),new Promise(function(n,a){var i;if(!(i=r.exifOrientation))return eB(e).then((function(e){try{return i=e,o.call(this)}catch(e){return a(e)}}).bind(this),a);function o(){return n(i)}return o.call(this)}).then((function(n){try{return f=n,E(),ez().then((function(n){try{return c=n?u:eO(u,f),E(),h=r.initialQuality||1,m=r.fileType||e.type,eT(c,m,e.name,e.lastModified,h).then((function(n){try{var o;if(p=n,E(),g=p.size>l,b=p.size>e.size,!g&&!b)return U(100),a(p);function f(){if(s--&&(v>l||v>x)){let r,n;return r=N?.95*_.width:_.width,n=N?.95*_.height:_.height,[A,j]=eM(r,n),j.drawImage(_,0,0,r,n),h*="image/png"===m?.85:.95,eT(A,m,e.name,e.lastModified,h).then(function(e){try{return w=e,eI(_),_=A,v=w.size,U(Math.min(99,Math.floor((y-v)/(y-l)*100))),f}catch(e){return i(e)}},i)}return[1]}return x=e.size,v=y=p.size,_=c,N=!r.alwaysKeepResolution&&g,(o=(function(e){for(;e;){if(e.then)return void e.then(o,i);try{if(e.pop){if(e.length)return e.pop()?k.call(this):e;e=f}else e=e.call(this)}catch(e){return i(e)}}}).bind(this))(f);function k(){return eI(_),eI(A),eI(u),eI(c),eI(d),U(100),a(w)}}catch(e){return i(e)}}).bind(this),i)}catch(e){return i(e)}}).bind(this),i)}catch(e){return i(e)}}).bind(this),i)}catch(e){return i(e)}}).bind(this),i)})}function eQ(e,n){return new Promise(function(a,i){let o,s,l,d,u,f;if(o={...n},l=0,{onProgress:d}=o,o.maxSizeMB=o.maxSizeMB||1/0,u="boolean"!=typeof o.useWebWorker||o.useWebWorker,delete o.useWebWorker,o.onProgress=e=>{l=e,"function"==typeof d&&d(l)},!(e instanceof Blob||e instanceof e_))return i(Error("The file given is not an instance of Blob or File"));if(!/^image/.test(e.type))return i(Error("The file given is not an image"));if(f="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,!u||"function"!=typeof Worker||f)return eD(e,o).then((function(e){try{return s=e,m.call(this)}catch(e){return i(e)}}).bind(this),i);var c=(function(){try{return m.call(this)}catch(e){return i(e)}}).bind(this),h=function(r){try{return eD(e,o).then(function(e){try{return s=e,c()}catch(e){return i(e)}},i)}catch(e){return i(e)}};try{return o.libURL=o.libURL||"https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js",new Promise((n,a)=>{var i;let s;r||(s=[],"function"==typeof(i="\nlet scriptImported = false\nself.addEventListener('message', async (e) => {\n  const { file, id, imageCompressionLibUrl, options } = e.data\n  options.onProgress = (progress) => self.postMessage({ progress, id })\n  try {\n    if (!scriptImported) {\n      // console.log('[worker] importScripts', imageCompressionLibUrl)\n      self.importScripts(imageCompressionLibUrl)\n      scriptImported = true\n    }\n    // console.log('[worker] self', self)\n    const compressedFile = await imageCompression(file, options)\n    self.postMessage({ file: compressedFile, id })\n  } catch (e) {\n    // console.error('[worker] error', e)\n    self.postMessage({ error: e.message + '\\n' + e.stack, id })\n  }\n})\n")?s.push(`(${i})()`):s.push(i),r=URL.createObjectURL(new Blob(s)));let l=new Worker(r);l.addEventListener("message",function(e){if(o.signal&&o.signal.aborted)l.terminate();else if(void 0===e.data.progress){if(e.data.error)return a(Error(e.data.error)),void l.terminate();n(e.data.file),l.terminate()}else o.onProgress(e.data.progress)}),l.addEventListener("error",a),o.signal&&o.signal.addEventListener("abort",()=>{a(o.signal.reason),l.terminate()}),l.postMessage({file:e,imageCompressionLibUrl:o.libURL,options:{...o,onProgress:void 0,signal:void 0}})}).then(function(e){try{return s=e,c()}catch(e){return h()}},h)}catch(e){h()}function m(){try{s.name=e.name,s.lastModified=e.lastModified}catch(e){}try{o.preserveExif&&"image/jpeg"===e.type&&(!o.fileType||o.fileType&&o.fileType===e.type)&&(s=eh(e,s))}catch(e){}return a(s)}})}function e$({isOpen:e,onClose:r}){let{user:n}=(0,d.useAuth)(),{t:a,language:i,setLanguage:o}=(0,et.useLanguage)(),{theme:h,setTheme:m,resolvedTheme:p}=(0,er.useTheme)(),[g,b]=(0,l.useState)(""),[y,v]=(0,l.useState)(null),[A,j]=(0,l.useState)(null),[_,N]=(0,l.useState)(!1),E=(0,l.useRef)(null);(0,l.useEffect)(()=>{n&&e&&(b(n.displayName||n.email?.split("@")[0]||""),j(n.photoURL),v(null))},[n,e]);let U=async()=>{if(n){N(!0);try{let e=n.photoURL;if(y){let r=y;try{r=await eQ(y,{maxSizeMB:.5,maxWidthOrHeight:1024,useWebWorker:!0,fileType:"image/jpeg"})}catch(e){console.error("Compression failed:",e)}let a=(0,es.ref)(u.storage,`avatars/${n.uid}.jpg`);await (0,es.uploadBytes)(a,r),e=await (0,es.getDownloadURL)(a)}await (0,c.updateProfile)(n,{displayName:g,photoURL:e});let a=(0,f.ref)(u.database,`users/${n.uid}`);await (0,f.update)(a,{name:g,photoURL:e,lastUpdated:Date.now()}),r()}catch(e){console.error("Error updating profile:",e),alert("Failed to update profile.")}finally{N(!1)}}};return e?(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",children:(0,s.jsxs)("div",{className:`${"light"===p?"bg-white":"bg-[#1E1E1E]"} w-full max-w-md rounded-2xl border border-neutral-200 dark:border-neutral-800 shadow-2xl overflow-hidden relative flex flex-col max-h-[90vh]`,children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-foreground",children:a("profile.title")}),(0,s.jsx)("button",{onClick:r,className:"p-2 hover:bg-muted rounded-full text-muted-foreground hover:text-foreground transition-colors",children:(0,s.jsx)(ei,{size:20})})]}),(0,s.jsxs)("div",{className:"p-6 flex flex-col gap-6 overflow-y-auto",children:[(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsxs)("div",{className:"relative group cursor-pointer",onClick:()=>E.current?.click(),children:[(0,s.jsx)("div",{className:"w-24 h-24 rounded-full border-2 border-primary overflow-hidden bg-muted flex items-center justify-center",children:A?(0,s.jsx)("img",{src:A,alt:"Avatar",className:"w-full h-full object-cover"}):(0,s.jsx)(w,{className:"w-10 h-10 text-muted-foreground"})}),(0,s.jsx)("div",{className:"absolute inset-0 bg-black/50 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:(0,s.jsx)(el,{className:"text-white w-6 h-6"})}),(0,s.jsx)("input",{type:"file",ref:E,onChange:e=>{if(e.target.files&&e.target.files[0]){let r=e.target.files[0];v(r),j(URL.createObjectURL(r))}},className:"hidden",accept:"image/*"})]})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wider",children:a("profile.display_name")}),(0,s.jsx)("input",{type:"text",value:g,onChange:e=>b(e.target.value),className:"w-full bg-input border border-border rounded-lg px-4 py-3 text-foreground focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary transition-all",placeholder:a("profile.display_name")})]}),(0,s.jsx)("div",{className:"h-[1px] bg-border w-full my-2"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("label",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wider flex items-center gap-2",children:[(0,s.jsx)(ed,{className:"w-3 h-3"})," ",a("profile.language")]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsx)("button",{onClick:()=>o("en"),className:`px-4 py-2 rounded-lg text-sm font-medium border transition-all ${"en"===i?"bg-primary/10 border-primary text-primary":"bg-input border-transparent text-muted-foreground hover:bg-muted"}`,children:"English"}),(0,s.jsx)("button",{onClick:()=>o("vi"),className:`px-4 py-2 rounded-lg text-sm font-medium border transition-all ${"vi"===i?"bg-primary/10 border-primary text-primary":"bg-input border-transparent text-muted-foreground hover:bg-muted"}`,children:"Ting Vit"})]})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("label",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wider flex items-center gap-2",children:[(0,s.jsx)(ec,{className:"w-3 h-3"})," ",a("profile.theme")]}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,s.jsxs)("button",{onClick:()=>m("light"),className:`flex flex-col items-center gap-1 p-2 rounded-lg text-xs font-medium border transition-all ${"light"===h?"bg-primary/10 border-primary text-primary":"bg-input border-transparent text-muted-foreground hover:bg-muted"}`,children:[(0,s.jsx)(ef,{className:"w-4 h-4"}),a("profile.light")]}),(0,s.jsxs)("button",{onClick:()=>m("dark"),className:`flex flex-col items-center gap-1 p-2 rounded-lg text-xs font-medium border transition-all ${"dark"===h?"bg-primary/10 border-primary text-primary":"bg-input border-transparent text-muted-foreground hover:bg-muted"}`,children:[(0,s.jsx)(eu,{className:"w-4 h-4"}),a("profile.dark")]}),(0,s.jsxs)("button",{onClick:()=>m("system"),className:`flex flex-col items-center gap-1 p-2 rounded-lg text-xs font-medium border transition-all ${"system"===h?"bg-primary/10 border-primary text-primary":"bg-input border-transparent text-muted-foreground hover:bg-muted"}`,children:[(0,s.jsx)(ec,{className:"w-4 h-4"}),a("profile.system")]})]})]})]}),(0,s.jsxs)("div",{className:"p-4 border-t border-border flex gap-3 justify-end bg-muted/20",children:[(0,s.jsx)("button",{onClick:r,disabled:_,className:"px-4 py-2 rounded-lg text-sm font-medium text-muted-foreground hover:text-foreground hover:bg-muted transition-colors disabled:opacity-50",children:a("common.cancel")}),(0,s.jsx)("button",{onClick:U,disabled:_||!g.trim(),className:"px-6 py-2 rounded-lg text-sm font-medium bg-primary text-primary-foreground hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:_?(0,s.jsx)(x,{className:"w-4 h-4 animate-spin"}):a("common.save")})]})]})}):null}eQ.getDataUrlFromFile=eU,eQ.getFilefromDataUrl=eE,eQ.loadImage=ek,eQ.drawImageInCanvas=eS,eQ.drawFileInCanvas=eR,eQ.canvasToFile=eT,eQ.getExifOrientation=eB,eQ.handleMaxWidthOrHeight=eP,eQ.followExifOrientation=eO,eQ.cleanupCanvasMemory=eI,eQ.isAutoOrientationInBrowser=ez,eQ.approximateBelowMaximumCanvasSizeOfBrowser=eC,eQ.copyExifWithoutOrientation=eh,eQ.getBrowserName=eF,eQ.version="2.0.2";let eq=b("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),eH=b("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),eZ=b("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);function eW({onChatStart:e}){let{user:r}=(0,d.useAuth)(),{requests:n,sendRequest:a,acceptRequest:i,rejectRequest:o,loading:c}=function(e){let[r,n]=(0,l.useState)([]),[a,i]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{if(!e)return;let r=(0,f.ref)(u.database,"friend_requests"),a=(0,f.query)(r,(0,f.orderByChild)("to"),(0,f.equalTo)(e.uid)),i=(0,f.onValue)(a,e=>{let r=e.val();r?n(Object.entries(r).map(([e,r])=>({id:e,...r})).filter(e=>"pending"===e.status)):n([])});return()=>i()},[e]),{requests:r,sendRequest:async r=>{if(!e||!r)return{success:!1,error:"Invalid data"};i(!0);try{let n=(0,f.ref)(u.database,"users"),a=(await (0,f.get)(n)).val(),o=null;if(a){for(let[e,n]of Object.entries(a))if(n.email===r){o={uid:e,...n};break}}if(!o)return i(!1),{success:!1,error:"User not found"};if(o.uid===e.uid)return i(!1),{success:!1,error:"Cannot add yourself"};let s=(0,f.push)((0,f.ref)(u.database,"friend_requests"));return await (0,f.update)(s,{from:e.uid,fromName:e.displayName||"Unknown",fromPhoto:e.photoURL||"",to:o.uid,status:"pending",timestamp:Date.now()}),i(!1),{success:!0}}catch(e){return i(!1),{success:!1,error:e.message}}},acceptRequest:async(r,n)=>{if(e)try{let a=(0,f.ref)(u.database,`friend_requests/${r}`);await (0,f.update)(a,{status:"accepted"}),(0,f.ref)(u.database,`users/${e.uid}/friends/${n}`),await (0,f.update)((0,f.ref)(u.database,`users/${e.uid}/friends`),{[n]:!0}),(0,f.ref)(u.database,`users/${n}/friends/${e.uid}`),await (0,f.update)((0,f.ref)(u.database,`users/${n}/friends`),{[e.uid]:!0})}catch(e){console.error("Error accepting",e)}},rejectRequest:async e=>{let r=(0,f.ref)(u.database,`friend_requests/${e}`);await (0,f.update)(r,{status:"rejected"})},loading:a}}(r),{resolvedTheme:h}=(0,er.useTheme)(),{friends:m}=ee(r),{t:p}=(0,et.useLanguage)(),[g,b]=(0,l.useState)(""),[y,v]=(0,l.useState)(null),A=async()=>{if(!g.trim())return;v(null);let e=await a(g.trim());e.success?(v({success:!0,msg:p("friends.request_sent")}),b("")):v({success:!1,msg:e.error||p("friends.failed")})};return(0,s.jsxs)("div",{className:`${"light"===h?"bg-white":"bg-[#1E1E1E]"} w-full max-w-md rounded-2xl border border-neutral-200 dark:border-neutral-800 shadow-2xl overflow-hidden flex flex-col max-h-[80vh] pb-[env(safe-area-inset-bottom)]`,children:[(0,s.jsx)("div",{className:"p-4 border-b border-border",children:(0,s.jsx)("h2",{className:"text-lg font-semibold text-foreground",children:p("friends.title")})}),(0,s.jsxs)("div",{className:"p-4 overflow-y-auto space-y-6 custom-scrollbar",children:[(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("h3",{className:"text-xs font-bold text-muted-foreground uppercase",children:p("friends.add_by_email")}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)("div",{className:"relative flex-1",children:[(0,s.jsx)("input",{type:"email",value:g,onChange:e=>b(e.target.value),placeholder:p("friends.email_placeholder"),className:"w-full bg-input border border-border rounded-lg pl-9 pr-4 py-2 text-foreground text-sm focus:outline-none focus:border-primary transition-colors placeholder:text-muted-foreground"}),(0,s.jsx)(eq,{className:"absolute left-3 top-2.5 text-muted-foreground w-4 h-4"})]}),(0,s.jsx)("button",{onClick:A,disabled:c||!g,className:"bg-primary text-primary-foreground px-3 py-2 rounded-lg font-medium text-sm hover:bg-primary/90 disabled:opacity-50 flex items-center gap-2",children:c?(0,s.jsx)(x,{className:"w-4 h-4 animate-spin"}):(0,s.jsx)(eH,{className:"w-4 h-4"})})]}),y&&(0,s.jsx)("p",{className:`text-xs ${y.success?"text-green-500":"text-destructive"}`,children:y.msg})]}),n.length>0&&(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("h3",{className:"text-xs font-bold text-primary uppercase",children:[p("friends.pending_requests")," (",n.length,")"]}),(0,s.jsx)("div",{className:"space-y-2",children:n.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between bg-muted/30 p-3 rounded-lg border border-border",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded-full bg-muted overflow-hidden flex items-center justify-center border border-border",children:e.fromPhoto?(0,s.jsx)("img",{src:e.fromPhoto,className:"w-full h-full object-cover"}):(0,s.jsx)(w,{className:"w-4 h-4 text-muted-foreground"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-foreground",children:e.fromName}),(0,s.jsx)("p",{className:"text-[10px] text-muted-foreground",children:new Date(e.timestamp).toLocaleDateString()})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>i(e.id,e.from),className:"p-1.5 bg-green-500/10 text-green-500 rounded hover:bg-green-500/20 transition-colors",children:(0,s.jsx)(eZ,{className:"w-4 h-4"})}),(0,s.jsx)("button",{onClick:()=>o(e.id),className:"p-1.5 bg-red-500/10 text-red-500 rounded hover:bg-red-500/20 transition-colors",children:(0,s.jsx)(ei,{className:"w-4 h-4"})})]})]},e.id))})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("h3",{className:"text-xs font-bold text-muted-foreground uppercase",children:[p("friends.my_friends")," (",m.length,")"]}),0===m.length?(0,s.jsx)("p",{className:"text-sm text-muted-foreground italic",children:p("friends.no_friends")}):(0,s.jsx)("div",{className:"space-y-2",children:m.map(r=>(0,s.jsxs)("div",{className:"flex items-center justify-between bg-muted/30 p-2 rounded-lg hover:bg-muted/50 transition-colors cursor-pointer group",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("div",{className:"w-8 h-8 rounded-full bg-muted overflow-hidden flex items-center justify-center border border-border relative",children:["online"===r.status&&(0,s.jsx)("div",{className:"absolute top-0 right-0 w-2 h-2 bg-green-500 rounded-full border border-background"}),r.photoURL?(0,s.jsx)("img",{src:r.photoURL,alt:r.name,className:"w-full h-full object-cover"}):(0,s.jsx)(w,{className:"w-4 h-4 text-muted-foreground"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-foreground group-hover:text-primary transition-colors",children:r.name||"Unknown"}),(0,s.jsx)("p",{className:"text-[10px] text-muted-foreground",children:r.status||"offline"})]})]}),(0,s.jsx)("button",{onClick:n=>{n.stopPropagation(),e?.({uid:r.uid,displayName:r.name||"Friend",photoURL:r.photoURL})},className:"p-2 bg-muted hover:bg-primary/10 hover:text-primary rounded-full transition-colors text-muted-foreground",title:p("common.chat"),children:(0,s.jsx)(Y,{className:"w-4 h-4"})})]},r.uid))})]})]})]})}let eV=b("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),eG=b("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);function eK(){let{user:e,loading:r}=(0,d.useAuth)(),{t:n}=(0,et.useLanguage)(),{resolvedTheme:a}=(0,er.useTheme)(),i="light"===a?"bg-white":"bg-[#1E1E1E]",{location:o,speed:c}=function(e){let[r,n]=(0,l.useState)(null),[a,i]=(0,l.useState)(null);return(0,l.useEffect)(()=>{if(!e)return;if(!("geolocation"in navigator))return void console.error("Geolocation not supported");let r=navigator.geolocation.watchPosition(r=>{let{latitude:a,longitude:o,speed:s}=r.coords;n({lat:a,lng:o}),i(s);let l=(0,f.ref)(u.database,`users/${e.uid}`);(0,f.update)(l,{location:{lat:a,lng:o},speed:s,status:"online",lastUpdated:Date.now()}),(0,f.onDisconnect)(l).update({status:"offline"})},e=>{console.error("Error getting location:",e),console.error("Error details:",{code:e.code,message:e.message})},{enableHighAccuracy:!1,timeout:2e4,maximumAge:1e4});return()=>navigator.geolocation.clearWatch(r)},[e]),(0,l.useEffect)(()=>{e&&navigator.getBattery&&navigator.getBattery().then(r=>{let n=()=>{let n=(0,f.ref)(u.database,`users/${e.uid}`);(0,f.update)(n,{battery:Math.round(100*r.level),isCharging:r.charging})};n(),r.addEventListener("levelchange",n),r.addEventListener("chargingchange",n)})},[e]),{location:r,speed:a}}(e),[h,m]=(0,l.useState)(!1),[p,g]=(0,l.useState)(!1),[b,y]=(0,l.useState)(null);return r?(0,s.jsx)("main",{className:"flex min-h-screen items-center justify-center bg-background text-primary",children:(0,s.jsx)(x,{className:"w-10 h-10 animate-spin"})}):e?(0,s.jsxs)("main",{className:"flex h-[100dvh] flex-col bg-background relative overflow-hidden",children:[(0,s.jsx)(en,{userLocation:o,speed:c,onChatStart:e=>y(e),onOpenFriends:()=>g(!0)}),(0,s.jsxs)("div",{className:"absolute top-4 left-4 z-10 flex flex-col gap-3",children:[(0,s.jsx)("button",{onClick:()=>m(!0),className:`${i} p-3 rounded-full border border-neutral-200 dark:border-neutral-800 text-foreground/80 hover:text-foreground hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-all shadow-lg`,title:n("common.profile"),children:(0,s.jsx)(eV,{size:24})}),(0,s.jsx)("button",{onClick:()=>g(!0),className:`${i} p-3 rounded-full border border-neutral-200 dark:border-neutral-800 text-foreground/80 hover:text-foreground hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-all shadow-lg`,title:n("common.friends"),children:(0,s.jsx)(eG,{size:24})})]}),(0,s.jsx)(e$,{isOpen:h,onClose:()=>m(!1)}),p&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",children:(0,s.jsxs)("div",{className:"relative w-full max-w-md",children:[(0,s.jsxs)("button",{onClick:()=>g(!1),className:"absolute -top-12 right-0 p-2 text-white/50 hover:text-white flex items-center gap-1",children:[(0,s.jsx)(ei,{size:20})," ",n("common.close")]}),(0,s.jsx)(eW,{onChatStart:e=>{y(e),g(!1)}})]})}),b&&(0,s.jsx)(eo,{user:e,friendUid:b.uid,friendName:b.displayName,onClose:()=>y(null)})]}):(0,s.jsx)(j,{})}e.s(["default",()=>eK],52683)}]);